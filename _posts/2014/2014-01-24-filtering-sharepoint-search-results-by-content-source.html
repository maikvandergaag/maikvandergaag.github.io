---
title: Filtering SharePoint Search Results by Content Source
type: post
tags:
- Content Source
- CRM
- Result Source
- Search
- SharePoint 2013
date: 2014-01-24 09:46:41.000000000 +01:00
permalink: /2014/01/filtering-sharepoint-search-results-by-content-source/
categories:
- SharePoint
status: publish
---
<p>Working for one my projects we were looking for a solution to only retrieve search results for a specific Content Source. In our scenario we had a External Content Type that was linked to a “FilteredEMail” view of a CRM database.</p>
<p>We connected CRM to SharePoint in this scenario because searching in CRM for a specific email was a big problem and slowed down the complete CRM system. </p>
<p>What there was implemented on CRM was a small button to open a window&nbsp; / frame to a SharePoint Search page. On this SharePoint search page you could search for the specific Mail and then the result would link you back to CRM.</p>
<p>Creating the External Content Type wasn’t that hard. The main thing here If you would also like to search trough your external content type is to define a field as a Timestamp field in order to enable incremental search.</p>
<p><a href="http://msftplayground.com/wp-content/uploads/2014/01/image.png"><img title="Timestamp field" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="Timestamp field" src="/assets/archive/2014/01/image_thumb.png" width="368" height="210" /></a> </p>
<p>For us this was very important because we were dealing with more than a million items. After we had the external content type in place and created the profile pages we crawled the complete set of emails. </p>
<p>We than needed to create a result source in order to retrieve only the information from the external content type. On the Search Service Application page we clicked on the ‘Result Sources’ menu option and created a new Search Result Source. </p>
<p><a href="http://msftplayground.com/wp-content/uploads/2014/01/image1.png"><img title="New Result Source" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="New Result Source" src="/assets/archive/2014/01/image_thumb1.png" width="291" height="179" /></a> </p>
<p>After setting these properties we opened the Query Builder. Within the query builder you do not have a default option of some sort to start filtering the results by a specific content source. </p>
<p>When I took a closer look at the property filter drop down after selecting “--- Show All Managed properties ---“ you have a property called “ContentSource”. We selected this and filled in the value of our content source.</p>
<p><a href="http://msftplayground.com/wp-content/uploads/2014/01/image2.png"><img title="Query Builder" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="Query Builder" src="/assets/archive/2014/01/image_thumb2.png" width="281" height="191" /></a> </p>
<p>After that we used the default options for the rest of the properties and saved the result source. Following this hunch resulted in a result source that only returns items of a specific content source.</p>
<p><a href="http://msftplayground.com/wp-content/uploads/2014/01/image3.png"><img title="New Result Source 2" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="New Result Source 2" src="/assets/archive/2014/01/image_thumb3.png" width="341" height="111" /></a> </p>
<p>After that we created a “Display Template” to refer back to CRM if you are curious on how we accomplished that please let me know.</p>
