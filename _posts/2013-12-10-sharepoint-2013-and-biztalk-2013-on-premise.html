---
layout: post
title: SharePoint 2013 and Biztalk 2013 (On-Premise)
date: 2013-12-10 13:54:57.000000000 +01:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Azure DevOps
tags:
- BizTalk 2013
- SharePoint 2013
- SharePoint Adapter
meta:
  _wpas_done_all: '1'
  snap_isAutoPosted: '1'
  _wp_jd_bitly: http://bit.ly/19yYBTr
  _wp_jd_target: ''
  _jd_wp_twitter: 'a:2:{i:0;s:77:"New post: SharePoint 2013 and Biztalk 2013 (On-Premise)
    http://bit.ly/19yYBTr";i:1;s:80:"Post Edited: SharePoint 2013 and Biztalk 2013
    (On-Premise) http://bit.ly/19yYBTr";}'
  _wpt_failed: 'a:5:{s:6:"author";b:0;s:8:"sentence";s:77:"New post: SharePoint 2013
    and Biztalk 2013 (On-Premise) http://bit.ly/19yYBTr";s:5:"error";s:71:"This tweet
    is identical to another Tweet recently sent to this account.";s:4:"code";i:403;s:9:"timestamp";i:1386683705;}'
  _edit_last: '1'
  snap_MYURL: ''
  snapEdIT: '1'
  snapLI: s:492:"a:1:{i:0;a:12:{s:11:"isPrePosted";s:1:"1";s:8:"isPosted";s:1:"1";s:4:"pgID";s:123:"http://www.linkedin.com/updates?discuss=&amp;scope=22692038&amp;stype=M&amp;topic=5816172983974522880&amp;type=U&amp;a=AfXY";s:5:"pDate";s:19:"2013-12-10
    13:54:58";s:4:"doLI";s:1:"1";s:10:"AttachPost";s:1:"1";s:10:"SNAPformat";s:41:"New
    post has been published on %SITENAME%";s:11:"SNAPformatT";s:18:"New Post - %TITLE%";s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";b:0;s:9:"isAutoURL";s:1:"A";s:8:"urlToUse";b:0;}}";
  _jd_tweet_this: 'yes'
  _yoast_wpseo_focuskw_text_input: SharePoint 2013
  _yoast_wpseo_focuskw: SharePoint 2013
  _yoast_wpseo_linkdex: '75'
  _oembed_b7280214b74283d7a73b39f5e5331d80: "{{unknown}}"
  yuzo_related_post_metabox: a:1:{s:21:"yuzo_disabled_related";N;}
  medium_post: O:11:"Medium_Post":11:{s:16:"author_image_url";N;s:10:"author_url";N;s:11:"byline_name";N;s:12:"byline_email";N;s:10:"cross_link";N;s:2:"id";N;s:21:"follower_notification";N;s:7:"license";N;s:14:"publication_id";N;s:6:"status";N;s:3:"url";N;}
  _wds_opengraph: a:3:{s:5:"title";s:0:"";s:11:"description";s:0:"";s:6:"images";a:1:{i:0;s:0:"";}}
  _wds_twitter: a:3:{s:5:"title";s:0:"";s:11:"description";s:0:"";s:6:"images";a:1:{i:0;s:0:"";}}
  _wds_focus-keywords: SharePoint 2013
  _wds_title: ''
  _wds_metadesc: ''
  _wds_meta-robots-adv: ''
  _wds_meta-robots-nofollow: ''
  _wds_canonical: ''
author:
  login: maik@familie-vandergaag.nl
  email: maik@familie-vandergaag.nl
  display_name: Maik van der Gaag
  first_name: Maik
  last_name: van der Gaag
permalink: "/2013/12/sharepoint-2013-and-biztalk-2013-on-premise/"
---
<p>For a couple of days we have been trying to connect our On-Premise SharePoint 2013 environment with our On-Premise BizTalk 2013 environment using the SharePoint adapter.</p>
<p>During this process we encountered several errors that I would like to share with you.</p>
<p>After configuring the SharePoint Adapter (you can read about it on MSDN <a href="http://msdn.microsoft.com/en-us/library/jj684553(v=bts.80).aspx">here</a>) and trying to send our first document we encountered the first error message:</p>
<p><em>The adapter failed to transmit message going to send port "SendPort-SP" with URL "wss://sharepointsite.com:80/sites/data/DropOffLibrary". It will be retransmitted after the retry interval specified for this Send Port. Details:"The Windows SharePoint Services site was not found. The URL "</em><em>http://sharepointsite.com:80/sites/data/DropOffLibrary</em><em>" points to a SharePoint object for which there is no Windows SharePoint Services site.</em>
<p>Resolving this error is relatively easy. By enabling the “Windows Identity Framework” (WIF) within Windows Server 2012 this error will be resolved (Thanks <a href="http://www.solidsoft.com/blog/posts/2013/biztalk-integration-with-sharepoint-2013-online-%E2%80%93-troubleshooting.aspx">Vincent Rouet</a>).
<p>The second error that we received look like this:
<p><em>A message sent to adapter "Windows SharePoint Services" on send port "SharePoint" with URI "wsss://sharepointsite.com:80/sites/data/DropOffLibrary" is suspended. </em>
<p><em> Error details: [System.ServiceModel.CommunicationObjectFaultedException] The communication object, System.ServiceModel.Channels.ServiceChannel, cannot be used for communication because it is in the Faulted state.</em>
<p>Reading about this error concluded that this had to be some kind of security issue. We had filled in a domain user in the “SharePoint Online Password”&nbsp; and “SharePoint Online Username“ field of the adapter. When we changed the right properties to a Office 365 location using a Online login account everything seemed to be working fine.
<p>Leaving the “SharePoint Online Password”&nbsp; and “SharePoint Online Username“ field of the adapter empty raised a security exception. After some logical thinking we figured out the the account running the host should have access to the SharePoint.
<p>So what we did is creating a separate Host within BizTalk with a specific domain account and attach it to the SharePoint adapter. When you then leave the “SharePoint Online Password”&nbsp; and “SharePoint Online Username“ fields empty it will use the account that is specified for the host to add the documents to SharePoint.</p></p></p></p></p>
