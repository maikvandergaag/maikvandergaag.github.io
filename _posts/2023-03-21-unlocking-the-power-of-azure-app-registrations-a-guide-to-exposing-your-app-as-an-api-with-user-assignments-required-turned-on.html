---
layout: post
title: '"Exposing Azure App Registrations as Secure APIs: A Guide to Authentication
  with ''User Assignments Required'' Turned On"'
date: 2023-03-21 11:12:42.000000000 +01:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Azure
tags: []
meta:
  _thumbnail_id: '6865'
  _edit_last: '3'
  _yoast_wpseo_primary_category: ''
  _yoast_wpseo_focuskw: Azure App Registration as an API
  _yoast_wpseo_metadesc: Discover how to securely expose your Azure App Registration
    as an API with 'User Assignments Required' turned on in this guide.
  _yoast_wpseo_linkdex: '59'
  _yoast_wpseo_content_score: '60'
  _yoast_wpseo_estimated-reading-time-minutes: '4'
  _yoast_wpseo_wordproof_timestamp: ''
  _wds_opengraph: a:3:{s:5:"title";s:0:"";s:11:"description";s:0:"";s:6:"images";a:1:{i:0;s:0:"";}}
  _wds_twitter: a:3:{s:5:"title";s:0:"";s:11:"description";s:0:"";s:6:"images";a:1:{i:0;s:0:"";}}
  _wds_focus-keywords: Azure App Registration as an API
  _wds_title: ''
  _wds_metadesc: Discover how to securely expose your Azure App Registration as an
    API with 'User Assignments Required' turned on in this guide.
  _wds_meta-robots-adv: ''
  _wds_meta-robots-nofollow: ''
  _wds_canonical: ''
  _wds_analysis: a:3:{s:6:"errors";a:3:{s:27:"wds-checks::focus_stopwords";s:38:"There
    are stop words in focus keywords";s:24:"wds-checks::title_length";s:26:"Your SEO
    title is too long";s:28:"wds-checks::imgalts_keywords";s:57:"None of your image
    alt texts contain the focus keyword(s)";}s:10:"percentage";i:83;s:6:"checks";a:16:{s:5:"focus";a:3:{s:6:"status";b:1;s:7:"ignored";b:0;s:6:"result";a:1:{s:5:"state";b:1;}}s:15:"focus_stopwords";a:3:{s:6:"status";b:0;s:7:"ignored";b:0;s:6:"result";a:2:{s:5:"state";b:0;s:6:"phrase";s:10:"key
    phrase";}}s:14:"title_keywords";a:3:{s:6:"status";b:1;s:7:"ignored";b:0;s:6:"result";a:1:{s:5:"state";b:1;}}s:12:"title_length";a:3:{s:6:"status";b:0;s:7:"ignored";b:0;s:6:"result";a:2:{s:6:"length";i:143;s:5:"state";i:1;}}s:17:"metadesc_keywords";a:3:{s:6:"status";b:1;s:7:"ignored";b:0;s:6:"result";a:1:{s:5:"state";b:1;}}s:15:"metadesc_length";a:3:{s:6:"status";b:1;s:7:"ignored";b:0;s:6:"result";a:1:{s:5:"state";b:1;}}s:13:"slug_keywords";a:3:{s:6:"status";b:1;s:7:"ignored";b:0;s:6:"result";a:1:{s:5:"state";b:1;}}s:16:"slug_underscores";a:3:{s:6:"status";b:1;s:7:"ignored";b:0;s:6:"result";a:2:{s:5:"state";b:1;s:7:"mark_up";s:126:"unlocking-the-power-of-azure-app-registrations-a-guide-to-exposing-your-app-as-an-api-with-user-assignments-required-turned-on";}}s:13:"keywords_used";a:3:{s:6:"status";b:1;s:7:"ignored";b:0;s:6:"result";a:1:{s:5:"state";b:1;}}s:18:"metadesc_handcraft";a:3:{s:6:"status";b:1;s:7:"ignored";b:0;s:6:"result";a:1:{s:5:"state";b:1;}}s:16:"imgalts_keywords";a:3:{s:6:"status";b:0;s:7:"ignored";b:0;s:6:"result";a:5:{s:5:"state";b:0;s:7:"percent";i:0;s:12:"has_featured";b:1;s:7:"img_cnt";i:5;s:13:"focus_img_cnt";i:0;}}s:14:"content_length";a:3:{s:6:"status";b:1;s:7:"ignored";b:0;s:6:"result";a:3:{s:5:"state";b:1;s:3:"min";i:300;s:5:"count";i:516;}}s:15:"keyword_density";a:3:{s:6:"status";b:1;s:7:"ignored";b:0;s:6:"result";a:5:{s:5:"state";b:1;s:7:"density";d:1.600000000000000088817841970012523233890533447265625;s:3:"min";i:1;s:3:"max";i:3;s:4:"type";s:15:"primary
    keyword";}}s:11:"links_count";a:3:{s:6:"status";b:1;s:7:"ignored";b:0;s:6:"result";a:3:{s:5:"state";b:1;s:8:"internal";i:5;s:5:"total";i:5;}}s:13:"para_keywords";a:3:{s:6:"status";b:1;s:7:"ignored";b:0;s:6:"result";a:1:{s:5:"state";b:1;}}s:20:"subheadings_keywords";a:3:{s:6:"status";b:1;s:7:"ignored";b:0;s:6:"result";a:3:{s:5:"state";b:1;s:5:"count";i:3;s:10:"is_primary";b:1;}}}}
  _wds_analysis_extra: a:0:{}
  _wds_readability: a:4:{s:5:"score";i:59;s:9:"raw_score";i:59;s:11:"is_readable";b:0;s:5:"error";b:0;}
author:
  login: maik@familie-vandergaag.nl
  email: maik@familie-vandergaag.nl
  display_name: Maik van der Gaag
  first_name: Maik
  last_name: van der Gaag
permalink: "/2023/03/unlocking-the-power-of-azure-app-registrations-a-guide-to-exposing-your-app-as-an-api-with-user-assignments-required-turned-on/"
---
<p><!-- wp:paragraph --></p>
<p>Azure App Registrations are a powerful tool for managing resource access and integrating applications with Microsoft's cloud services. While these registrations are typically used to grant applications access to other Azure resources, they can also be exposed as APIs, allowing external applications to interact with the registered application's resources securely.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>In this blog post, we'll explore exposing an Azure App Registration as an API, including the necessary configuration to authenticate towards the application when the application is configured with 'User Assignments Required' turned on. This short guide tells you how to configure this.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>This guide talks about two different Application Registrations.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list {"ordered":true,"type":"1"} --></p>
<ol type="1"><!-- wp:list-item --></p>
<li>The application you are authenticating to. (This is the application registered on, for example, an Azure App Service)</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>The application you are authenticating with. (This is the application you will use to retrieve data from, for example, an API)</li>
<p><!-- /wp:list-item --></ol>
<p><!-- /wp:list --></p>
<p><!-- wp:heading --></p>
<h2>Step 1: Expose an API</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Ensure the application you are authenticating to (1) has an Application ID Url configured within the App Registration blade of the application.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":6857,"sizeSlug":"large","linkDestination":"media"} --></p>
<figure class="wp-block-image size-large"><a href="https://msftplayground.com/wp-content/uploads/2023/03/1.png" /><img src="{{ site.baseurl }}/assets/archive/2023/03/1-1024x548.png" alt="" class="wp-image-6857" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>If this is not configured, make sure to add it.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2>Step 2: Create an App Role</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>An 'App Role' needs to be defined to authenticate your application. For this, go to the 'App Role' blade for the App Registration you are authenticating to (1).</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":6859,"sizeSlug":"large","linkDestination":"media"} --></p>
<figure class="wp-block-image size-large"><a href="https://msftplayground.com/wp-content/uploads/2023/03/2.png" /><img src="{{ site.baseurl }}/assets/archive/2023/03/2-1024x449.png" alt="" class="wp-image-6859" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>If an App Role does not exist, create a new one and fill in the required properties. Make sure also to select Applications in the allowed "member types" and enable it. Adding these roles makes sure that the roles are added to the token of the application.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:table --></p>
<figure class="wp-block-table">
<table>
<tbody>
<tr>
<td><strong>Field</strong></td>
<td><strong>Description</strong></td>
<td><strong>Example</strong></td>
</tr>
<tr>
<td><strong>Display Name</strong></td>
<td>Display the name for the app role that appears in the admin consent and app assignment experiences. This value may contain spaces.</td>
<td>Survey Writer</td>
</tr>
<tr>
<td><strong>Allowed member types</strong></td>
<td>Specifies whether this app role can be assigned to users, applications, or both.</td>
<td>Users/Groups</td>
</tr>
<tr>
<td><strong>Value</strong></td>
<td>Specifying the roles' value claim that the application should expect in the token. The value should match the string referenced in the application's code, which can't contain spaces.</td>
<td>Survey. Create</td>
</tr>
<tr>
<td><strong>Description</strong></td>
<td>A more detailed description of the app role displayed during admin app assignment and consent experiences.</td>
<td>Writers can create surveys.</td>
</tr>
<tr>
<td><strong>Do you want to enable this app role?</strong></td>
<td>Specifies whether the app role is enabled. To delete an app role, deselect this checkbox and apply the change before attempting the delete operation.</td>
<td><em>Checked</em></td>
</tr>
</tbody>
</table>
</figure>
<p><!-- /wp:table --></p>
<p><!-- wp:heading --></p>
<h2>Step 3: Add application API Permission</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>On the 'API Permission' blade of the application you are authenticating with (2), the required permissions for the application need to be configured. In the blade, click 'Add permission.'</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Then go to the tab "APIs" my organization uses and search for your App Registration. You should be able to see the name within the list.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":6861,"sizeSlug":"large","linkDestination":"media"} --></p>
<figure class="wp-block-image size-large"><a href="https://msftplayground.com/wp-content/uploads/2023/03/3.png" /><img src="{{ site.baseurl }}/assets/archive/2023/03/3-1024x517.png" alt="" class="wp-image-6861" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Click on the application. On the next screen, you should be able to see the roles that you can choose. Select the permissions that are required and click on "Add Permissions."</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":6863,"sizeSlug":"large","linkDestination":"media"} --></p>
<figure class="wp-block-image size-large"><a href="https://msftplayground.com/wp-content/uploads/2023/03/5.png" /><img src="{{ site.baseurl }}/assets/archive/2023/03/5-921x1024.png" alt="" class="wp-image-6863" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:heading --></p>
<h2>Step 4: Admin Consent</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>These types of app roles require an 'Admin Consent.' After adding the permission, you will be returned to the API permissions blade. In this blade, click on 'Grant admin consent for.'</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":6865,"sizeSlug":"large","linkDestination":"media"} --></p>
<figure class="wp-block-image size-large"><a href="https://msftplayground.com/wp-content/uploads/2023/03/6.png" /><img src="{{ site.baseurl }}/assets/archive/2023/03/6-1024x452.png" alt="" class="wp-image-6865" /></figure>
<p><!-- /wp:image --></p>
