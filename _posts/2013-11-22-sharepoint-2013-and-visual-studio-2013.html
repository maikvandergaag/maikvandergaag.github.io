---
title: SharePoint 2013 and Visual Studio 2013
type: post
tags:
- SharePoint 2013
- Visual Studio 2013
date: 2013-11-22 07:53:45.000000000 +01:00
permalink: /2013/11/sharepoint-2013-and-visual-studio-2013/
categories:
- Development
status: publish
---
<p>For a few weeks I have been using Visual Studio on my normal development environment. Yesterday I decided to install it on a SharePoint 2013 development environment we have at a client.</p>
<p>This development machine already had a Visual Studio 2012 installation so we first uninstalled the 2012 installation. After the uninstall we installed Visual Studio 2013. After rebooting machine strange things started to happen.</p>
<ul>
<li>SharePoint Designer could not connect any more to my SharePoint sites. </li>
<li>SharePoint Controls did not work anymore. The content search web part always returned a error:</li>
</ul>
<p><strong><em>Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.</em></strong></p>
<ul>
<li>Errors in the ULS log:</li>
</ul>
<p><em><strong>11/21/2013 14:35:27.81&nbsp;&nbsp;&nbsp;&nbsp; w3wp.exe (0x0DA0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x23B4&nbsp;&nbsp;&nbsp; SharePoint Server Search&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Query&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; afpkb&nbsp;&nbsp;&nbsp; Unexpected&nbsp;&nbsp;&nbsp; Getting results failed: System.Reflection.ReflectionTypeLoadException: Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.RuntimeModule.GetTypes(RuntimeModule module)&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.RuntimeModule.GetTypes()&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.Assembly.GetTypes()&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.ProxyMap.ProcessOneAssembly(Assembly azzembly, ClientServiceHost processorSurrogate)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.ProxyMap.Init(ClientServiceHost processorSurrogate)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.ProxyMap.EnsureInited(ClientServiceHost processorSurrogate)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.ProxyMap.GetServerStub(Type type, ClientServiceHost processorSurrogate)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.DataConv...&nbsp;&nbsp;&nbsp;&nbsp; <br />11/21/2013 14:35:27.81*&nbsp;&nbsp;&nbsp; w3wp.exe (0x0DA0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x23B4&nbsp;&nbsp;&nbsp; SharePoint Server Search&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Query&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; afpkb&nbsp;&nbsp;&nbsp; Unexpected&nbsp;&nbsp;&nbsp; ...erter.WriteAsJson(JsonWriter writer, Object obj, ProxyContext proxyContext, JsonSerializationOptions options)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.JsonUtility.SerializeToJson(Object value, TextWriter writer, JsonSerializationOptions options)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.JsonUtility.SerializeToJson(Object value)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Office.Server.Search.WebControls.DataProviderScriptWebPart.GetInitialResult()&nbsp;&nbsp;&nbsp;&nbsp; <br />11/21/2013 14:35:27.81&nbsp;&nbsp;&nbsp;&nbsp; w3wp.exe (0x0DA0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x23B4&nbsp;&nbsp;&nbsp; SharePoint Server Search&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Query&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; afpkb&nbsp;&nbsp;&nbsp; Unexpected&nbsp;&nbsp;&nbsp; Getting results failed: System.Reflection.ReflectionTypeLoadException: Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.RuntimeModule.GetTypes(RuntimeModule module)&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.RuntimeModule.GetTypes()&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.Assembly.GetTypes()&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.ProxyMap.ProcessOneAssembly(Assembly azzembly, ClientServiceHost processorSurrogate)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.ProxyMap.Init(ClientServiceHost processorSurrogate)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.ProxyMap.EnsureInited(ClientServiceHost processorSurrogate)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.ProxyMap.GetServerStub(Type type, ClientServiceHost processorSurrogate)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.DataConv...&nbsp;&nbsp;&nbsp;&nbsp; <br />11/21/2013 14:35:27.81*&nbsp;&nbsp;&nbsp; w3wp.exe (0x0DA0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x23B4&nbsp;&nbsp;&nbsp; SharePoint Server Search&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Query&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; afpkb&nbsp;&nbsp;&nbsp; Unexpected&nbsp;&nbsp;&nbsp; ...erter.WriteAsJson(JsonWriter writer, Object obj, ProxyContext proxyContext, JsonSerializationOptions options)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.JsonUtility.SerializeToJson(Object value, TextWriter writer, JsonSerializationOptions options)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.JsonUtility.SerializeToJson(Object value)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.Office.Server.Search.WebControls.DataProviderScriptWebPart.GetInitialResult()&nbsp;&nbsp;&nbsp;&nbsp; <br />11/21/2013 14:35:27.81&nbsp;&nbsp;&nbsp;&nbsp; w3wp.exe (0x0DA0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0x23B4&nbsp;&nbsp;&nbsp; SharePoint Server Search&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Query&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; afpkb&nbsp;&nbsp;&nbsp; Unexpected&nbsp;&nbsp;&nbsp; Getting results failed: System.Reflection.ReflectionTypeLoadException: Unable to load one or more of the requested types. Retrieve the LoaderExceptions property for more information.&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.RuntimeModule.GetTypes(RuntimeModule module)&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.RuntimeModule.GetTypes()&nbsp;&nbsp;&nbsp;&nbsp; at System.Reflection.Assembly.GetTypes()&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.ProxyMap.ProcessOneAssembly(Assembly azzembly, ClientServiceHost processorSurrogate)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.ProxyMap.Init(ClientServiceHost processorSurrogate)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.ProxyMap.EnsureInited(ClientServiceHost processorSurrogate)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.ProxyMap.GetServerStub(Type type, ClientServiceHost processorSurrogate)&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.SharePoint.Client.DataConv...</strong></em>&nbsp;&nbsp;&nbsp;&nbsp;
<p>We started looking for the problem and tried the following list already:</p>
<ul>
<li>Uninstall the Office developer tools for Visual Studio 2012.</li>
<li>Repair the SharePoint 2013 installation.</li>
<li>Run the Configuration wizard of SharePoint. This also returned a error. Looking in the upgrade log we could not find a real exception.</li>
</ul>
<p>After all this work we decided to reinstall Visual Studio 2012 to check if that would work and it did!! For now we choose to run both version on our development system. If there is someone that knows what is going wrong please let us know.</p></p>
