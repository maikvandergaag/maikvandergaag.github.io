---
title: Unable to start User Profile Synchronization Service
type: post
tags:
- Administration
- Error
- Exception
- SharePoint 2013
- Userprofile Synchronization
date: 2014-02-04 14:02:28.000000000 +01:00
permalink: /2014/02/unable-to-start-user-profile-synchronization-service/
categories:
- SharePoint
status: publish
---
<p>A few days ago I wrote a post about loading modules in PowerShell by default: “<a href="http://msftplayground.com/2014/01/load-modules-by-default-when-openening-powershell/">Load modules by default when opening PowerShell</a>”. Today we had to setup a new SharePoint Farm and to perform some default operations we created the PowerShell profile described in that post.</p>
<p>The complete configuration of the server went well until we wanted to start the “User Profile Synchronization Service”. The Service moves to starting and the timer job that configures the service also starts but after 5 seconds it already stops.</p>
<p>Looking at the ULS log we found this error message:</p>
<blockquote><p>“UserProfileApplication.SynchronizeMIIS: Failed to configure MIIS post database, will attempt during next rerun. Exception: System.Runtime.InteropServices.SEHException (0x80004005): External component has thrown an exception.<br />
at Microsoft.Office.Server.UserProfiles.Synchronization.ILMPostSetupConfiguration.ConfigureMiisStage2()<br />
at Microsoft.Office.Server.Administration.UserProfileApplication.SetupSynchronizationService(ProfileSynchronizationServiceInstance profileSyncInstance).”</p></blockquote>
<p>This message did not gave us a clue at all. At the same time we were working on the PowerShell Profiles and had temporary removed our custom profile from the service.</p>
<p>Provisioning the “User Profile Synchronization Service” without the custom profile resulted in success. So remember when you want to provision the “User Profile Synchronization Service” make sure you are not using a custom PowerShell profile.</p>
