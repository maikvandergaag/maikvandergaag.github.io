<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Create a custom component to deploy SharePoint Solutions – Part 2 - Microsoft Playground</title>
<meta name="description" content="In the first part of the series we have adjusted a build template in order to copy content from source control to the drop location after the build. This content can then be used to supply release management with information about the deployment. This functionality will be used to copy a configuration file to the drop location. With PowerShell were our custom component will exist off we can read out that configuration file. As you can read we will create our custom component in specific steps and we will start with the configuration file.  Configuration File The configuration file will contain all of the information that is needed to deploy a SharePoint solution package. As example you would like to know to which web application the solution needs to be deployed to. As example take a look at the following sample configuration file: &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt; &lt;!--    Section to specify the configuration for the deployment --&gt; &lt;Configuration&gt;   &lt;!--     Section to specify environment information   --&gt;   &lt;Environment&gt;     &lt;DEV&gt;       &lt;WebApplications&gt;         &lt;WebApplication ID=&quot;1&quot; Url=&quot;http://sample.msftplayground.local&quot;&gt;&lt;/WebApplication&gt;       &lt;/WebApplications&gt;     &lt;/DEV&gt;     &lt;TST&gt;       &lt;WebApplications&gt;         &lt;WebApplication ID=&quot;1&quot; Url=&quot;http://sample-tst.msftplayground.local&quot;&gt;&lt;/WebApplication&gt;       &lt;/WebApplications&gt;     &lt;/TST&gt;     &lt;ACC&gt;       &lt;WebApplications&gt;         &lt;WebApplication ID=&quot;1&quot; Url=&quot;http://sample-acc.msftplayground.local&quot;&gt;&lt;/WebApplication&gt;       &lt;/WebApplications&gt;     &lt;/ACC&gt;     &lt;PROD&gt;       &lt;WebApplications&gt;         &lt;WebApplication ID=&quot;1&quot; Url=&quot;http://sample.msftplayground.local&quot;&gt;&lt;/WebApplication&gt;       &lt;/WebApplications&gt;     &lt;/PROD&gt;   &lt;/Environment&gt;   &lt;!--     Section to specify information on solutions were to deploy to or retract.     --&gt;   &lt;Solutions&gt;     &lt;!--     Section to specify the solutions that need to deployed.     --&gt;     &lt;Deploy&gt;       &lt;!--       Section to specify specific solution information              Name = Name of the solution        Upgrade = Upgrade the solution if it exists       DeployToAll = Deploy to all content applications       DeployNotExits = Deploy the solution if it does not exist when upgrade is set to true       WebApplication = The web application to deploy to specified with the ID when deploy to all is false       --&gt;       &lt;Solution Name=&quot;MSFTPlayground.SharePoint.wsp&quot; Upgrade=&quot;true&quot; DeployToAll=&quot;false&quot; DeployNotExists=&quot;true&quot;&gt;         &lt;WebApplication ID=&quot;1&quot; /&gt;         &lt;WebApplication ID=&quot;2&quot; /&gt;         &lt;WebApplication ID=&quot;3&quot; /&gt;       &lt;/Solution&gt;     &lt;/Deploy&gt;     &lt;Retract&gt;       &lt;!--       Section to specify specific solution information              Name = Name of the solution        Remove = Remove the solution after retraction       RetractAll = Retract from all content applications       --&gt;       &lt;Solution Name=&quot;MSFTPlayground.SharePoint.wsp&quot; Remove=&quot;true&quot; RetractAll=&quot;true&quot;&gt;         &lt;WebApplication ID=&quot;1&quot; /&gt;         &lt;WebApplication ID=&quot;2&quot; /&gt;         &lt;WebApplication ID=&quot;3&quot; /&gt;       &lt;/Solution&gt;     &lt;/Retract&gt;   &lt;/Solutions&gt; &lt;/Configuration&gt;  In the configuration file you can specify which solution package you would like to deploy and to what web application. The web applications are specified in the “Environment” section. The configuration file contains a “Environment” section to be able to use the same mechanism for multiple environments that use different URLs. Within the solution section we then refer to a specific web application by its ID. To make it more complex we also added some other properties (Upgrade, DeployToAll) to make the components more advanced. PowerShell With the configuration file we can start writing the PowerShell that will read out the configuration file and deploys the solution. param(     [string]$filename = $(throw &quot;Specify the Config filename that is located in the drop folder&quot;),     [string]$environment = $(throw &quot;Specify the Environment you would like to deploy to.&quot;) )">


  <meta name="author" content="Maik van der Gaag">
  
  <meta property="article:author" content="Maik van der Gaag">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Microsoft Playground">
<meta property="og:title" content="Create a custom component to deploy SharePoint Solutions – Part 2">
<meta property="og:url" content="http://localhost:4000/2015/01/create-custom-component-deploy-sharepoint-solutions-part-2/">


  <meta property="og:description" content="In the first part of the series we have adjusted a build template in order to copy content from source control to the drop location after the build. This content can then be used to supply release management with information about the deployment. This functionality will be used to copy a configuration file to the drop location. With PowerShell were our custom component will exist off we can read out that configuration file. As you can read we will create our custom component in specific steps and we will start with the configuration file.  Configuration File The configuration file will contain all of the information that is needed to deploy a SharePoint solution package. As example you would like to know to which web application the solution needs to be deployed to. As example take a look at the following sample configuration file: &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt; &lt;!--    Section to specify the configuration for the deployment --&gt; &lt;Configuration&gt;   &lt;!--     Section to specify environment information   --&gt;   &lt;Environment&gt;     &lt;DEV&gt;       &lt;WebApplications&gt;         &lt;WebApplication ID=&quot;1&quot; Url=&quot;http://sample.msftplayground.local&quot;&gt;&lt;/WebApplication&gt;       &lt;/WebApplications&gt;     &lt;/DEV&gt;     &lt;TST&gt;       &lt;WebApplications&gt;         &lt;WebApplication ID=&quot;1&quot; Url=&quot;http://sample-tst.msftplayground.local&quot;&gt;&lt;/WebApplication&gt;       &lt;/WebApplications&gt;     &lt;/TST&gt;     &lt;ACC&gt;       &lt;WebApplications&gt;         &lt;WebApplication ID=&quot;1&quot; Url=&quot;http://sample-acc.msftplayground.local&quot;&gt;&lt;/WebApplication&gt;       &lt;/WebApplications&gt;     &lt;/ACC&gt;     &lt;PROD&gt;       &lt;WebApplications&gt;         &lt;WebApplication ID=&quot;1&quot; Url=&quot;http://sample.msftplayground.local&quot;&gt;&lt;/WebApplication&gt;       &lt;/WebApplications&gt;     &lt;/PROD&gt;   &lt;/Environment&gt;   &lt;!--     Section to specify information on solutions were to deploy to or retract.     --&gt;   &lt;Solutions&gt;     &lt;!--     Section to specify the solutions that need to deployed.     --&gt;     &lt;Deploy&gt;       &lt;!--       Section to specify specific solution information              Name = Name of the solution        Upgrade = Upgrade the solution if it exists       DeployToAll = Deploy to all content applications       DeployNotExits = Deploy the solution if it does not exist when upgrade is set to true       WebApplication = The web application to deploy to specified with the ID when deploy to all is false       --&gt;       &lt;Solution Name=&quot;MSFTPlayground.SharePoint.wsp&quot; Upgrade=&quot;true&quot; DeployToAll=&quot;false&quot; DeployNotExists=&quot;true&quot;&gt;         &lt;WebApplication ID=&quot;1&quot; /&gt;         &lt;WebApplication ID=&quot;2&quot; /&gt;         &lt;WebApplication ID=&quot;3&quot; /&gt;       &lt;/Solution&gt;     &lt;/Deploy&gt;     &lt;Retract&gt;       &lt;!--       Section to specify specific solution information              Name = Name of the solution        Remove = Remove the solution after retraction       RetractAll = Retract from all content applications       --&gt;       &lt;Solution Name=&quot;MSFTPlayground.SharePoint.wsp&quot; Remove=&quot;true&quot; RetractAll=&quot;true&quot;&gt;         &lt;WebApplication ID=&quot;1&quot; /&gt;         &lt;WebApplication ID=&quot;2&quot; /&gt;         &lt;WebApplication ID=&quot;3&quot; /&gt;       &lt;/Solution&gt;     &lt;/Retract&gt;   &lt;/Solutions&gt; &lt;/Configuration&gt;  In the configuration file you can specify which solution package you would like to deploy and to what web application. The web applications are specified in the “Environment” section. The configuration file contains a “Environment” section to be able to use the same mechanism for multiple environments that use different URLs. Within the solution section we then refer to a specific web application by its ID. To make it more complex we also added some other properties (Upgrade, DeployToAll) to make the components more advanced. PowerShell With the configuration file we can start writing the PowerShell that will read out the configuration file and deploys the solution. param(     [string]$filename = $(throw &quot;Specify the Config filename that is located in the drop folder&quot;),     [string]$environment = $(throw &quot;Specify the Environment you would like to deploy to.&quot;) )">



  <meta property="og:image" content="http://localhost:4000/assets/profile/profile.png">



  <meta name="twitter:site" content="@maikvandergaag">
  <meta name="twitter:title" content="Create a custom component to deploy SharePoint Solutions – Part 2">
  <meta name="twitter:description" content="In the first part of the series we have adjusted a build template in order to copy content from source control to the drop location after the build. This content can then be used to supply release management with information about the deployment. This functionality will be used to copy a configuration file to the drop location. With PowerShell were our custom component will exist off we can read out that configuration file. As you can read we will create our custom component in specific steps and we will start with the configuration file.  Configuration File The configuration file will contain all of the information that is needed to deploy a SharePoint solution package. As example you would like to know to which web application the solution needs to be deployed to. As example take a look at the following sample configuration file: &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt; &lt;!--    Section to specify the configuration for the deployment --&gt; &lt;Configuration&gt;   &lt;!--     Section to specify environment information   --&gt;   &lt;Environment&gt;     &lt;DEV&gt;       &lt;WebApplications&gt;         &lt;WebApplication ID=&quot;1&quot; Url=&quot;http://sample.msftplayground.local&quot;&gt;&lt;/WebApplication&gt;       &lt;/WebApplications&gt;     &lt;/DEV&gt;     &lt;TST&gt;       &lt;WebApplications&gt;         &lt;WebApplication ID=&quot;1&quot; Url=&quot;http://sample-tst.msftplayground.local&quot;&gt;&lt;/WebApplication&gt;       &lt;/WebApplications&gt;     &lt;/TST&gt;     &lt;ACC&gt;       &lt;WebApplications&gt;         &lt;WebApplication ID=&quot;1&quot; Url=&quot;http://sample-acc.msftplayground.local&quot;&gt;&lt;/WebApplication&gt;       &lt;/WebApplications&gt;     &lt;/ACC&gt;     &lt;PROD&gt;       &lt;WebApplications&gt;         &lt;WebApplication ID=&quot;1&quot; Url=&quot;http://sample.msftplayground.local&quot;&gt;&lt;/WebApplication&gt;       &lt;/WebApplications&gt;     &lt;/PROD&gt;   &lt;/Environment&gt;   &lt;!--     Section to specify information on solutions were to deploy to or retract.     --&gt;   &lt;Solutions&gt;     &lt;!--     Section to specify the solutions that need to deployed.     --&gt;     &lt;Deploy&gt;       &lt;!--       Section to specify specific solution information              Name = Name of the solution        Upgrade = Upgrade the solution if it exists       DeployToAll = Deploy to all content applications       DeployNotExits = Deploy the solution if it does not exist when upgrade is set to true       WebApplication = The web application to deploy to specified with the ID when deploy to all is false       --&gt;       &lt;Solution Name=&quot;MSFTPlayground.SharePoint.wsp&quot; Upgrade=&quot;true&quot; DeployToAll=&quot;false&quot; DeployNotExists=&quot;true&quot;&gt;         &lt;WebApplication ID=&quot;1&quot; /&gt;         &lt;WebApplication ID=&quot;2&quot; /&gt;         &lt;WebApplication ID=&quot;3&quot; /&gt;       &lt;/Solution&gt;     &lt;/Deploy&gt;     &lt;Retract&gt;       &lt;!--       Section to specify specific solution information              Name = Name of the solution        Remove = Remove the solution after retraction       RetractAll = Retract from all content applications       --&gt;       &lt;Solution Name=&quot;MSFTPlayground.SharePoint.wsp&quot; Remove=&quot;true&quot; RetractAll=&quot;true&quot;&gt;         &lt;WebApplication ID=&quot;1&quot; /&gt;         &lt;WebApplication ID=&quot;2&quot; /&gt;         &lt;WebApplication ID=&quot;3&quot; /&gt;       &lt;/Solution&gt;     &lt;/Retract&gt;   &lt;/Solutions&gt; &lt;/Configuration&gt;  In the configuration file you can specify which solution package you would like to deploy and to what web application. The web applications are specified in the “Environment” section. The configuration file contains a “Environment” section to be able to use the same mechanism for multiple environments that use different URLs. Within the solution section we then refer to a specific web application by its ID. To make it more complex we also added some other properties (Upgrade, DeployToAll) to make the components more advanced. PowerShell With the configuration file we can start writing the PowerShell that will read out the configuration file and deploys the solution. param(     [string]$filename = $(throw &quot;Specify the Config filename that is located in the drop folder&quot;),     [string]$environment = $(throw &quot;Specify the Environment you would like to deploy to.&quot;) )">
  <meta name="twitter:url" content="http://localhost:4000/2015/01/create-custom-component-deploy-sharepoint-solutions-part-2/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="http://localhost:4000/assets/profile/profile.png">
    
  

  



  <meta property="article:published_time" content="2015-01-09T14:39:02+01:00">






<link rel="canonical" href="http://localhost:4000/2015/01/create-custom-component-deploy-sharepoint-solutions-part-2/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Maik van der Gaag",
      "url": "http://localhost:4000/",
      "sameAs": ["https://twitter.com/maikvandergaag","https://github.com/maikvandergaag"]
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Microsoft Playground Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<link rel="stylesheet" href="/assets/css/custom.css">

<!-- You can set your favicon here -->
<link rel="icon" type="image/png" sizes="32x32" href="/favicon.png">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Microsoft Playground
          <span class="site-subtitle">debug.write('Architecture, Azure, Azure DevOps, Git, GitHub, DevOps');</span>
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/about">About</a>
            </li>
<li class="masthead__menu-item">
              <a href="/extensions">Extensions</a>
            </li>
<li class="masthead__menu-item">
              <a href="/speaking">Speaking</a>
            </li>
<li class="masthead__menu-item">
              <a href="/year-archive">Posts</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories">Categories</a>
            </li>
</ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/profile/profile.png" alt="Maik van der Gaag" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Maik van der Gaag</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>I am <strong>Microsoft Azure MVP</strong>, <strong>Speaker</strong> and <strong>Father</strong>.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Schiedam, The Netherlands</span>
        </li>
      

      
        
          
            <li><a href="https://twitter.com/maikvandergaag" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/maikvandergaag" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/maikvandergaag/" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">Linkedin</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Create a custom component to deploy SharePoint Solutions – Part 2">
    <meta itemprop="description" content='In the first part of the series we have adjusted a build template in order to copy content from source control to the drop location after the build. This content can then be used to supply release management with information about the deployment. This functionality will be used to copy a configuration file to the drop location. With PowerShell were our custom component will exist off we can read out that configuration file.As you can read we will create our custom component in specific steps and we will start with the configuration file. Configuration FileThe configuration file will contain all of the information that is needed to deploy a SharePoint solution package. As example you would like to know to which web application the solution needs to be deployed to.As example take a look at the following sample configuration file:&lt;?xml version="1.0" encoding="utf-8" ?&gt;&lt;!--   Section to specify the configuration for the deployment--&gt;&lt;Configuration&gt;  &lt;!--    Section to specify environment information  --&gt;  &lt;Environment&gt;    &lt;DEV&gt;      &lt;WebApplications&gt;        &lt;WebApplication ID="1" Url="http://sample.msftplayground.local"&gt;&lt;/WebApplication&gt;      &lt;/WebApplications&gt;    &lt;/DEV&gt;    &lt;TST&gt;      &lt;WebApplications&gt;        &lt;WebApplication ID="1" Url="http://sample-tst.msftplayground.local"&gt;&lt;/WebApplication&gt;      &lt;/WebApplications&gt;    &lt;/TST&gt;    &lt;ACC&gt;      &lt;WebApplications&gt;        &lt;WebApplication ID="1" Url="http://sample-acc.msftplayground.local"&gt;&lt;/WebApplication&gt;      &lt;/WebApplications&gt;    &lt;/ACC&gt;    &lt;PROD&gt;      &lt;WebApplications&gt;        &lt;WebApplication ID="1" Url="http://sample.msftplayground.local"&gt;&lt;/WebApplication&gt;      &lt;/WebApplications&gt;    &lt;/PROD&gt;  &lt;/Environment&gt;  &lt;!--    Section to specify information on solutions were to deploy to or retract.    --&gt;  &lt;Solutions&gt;    &lt;!--    Section to specify the solutions that need to deployed.    --&gt;    &lt;Deploy&gt;      &lt;!--      Section to specify specific solution information            Name = Name of the solution       Upgrade = Upgrade the solution if it exists      DeployToAll = Deploy to all content applications      DeployNotExits = Deploy the solution if it does not exist when upgrade is set to true      WebApplication = The web application to deploy to specified with the ID when deploy to all is false      --&gt;      &lt;Solution Name="MSFTPlayground.SharePoint.wsp" Upgrade="true" DeployToAll="false" DeployNotExists="true"&gt;        &lt;WebApplication ID="1" /&gt;        &lt;WebApplication ID="2" /&gt;        &lt;WebApplication ID="3" /&gt;      &lt;/Solution&gt;    &lt;/Deploy&gt;    &lt;Retract&gt;      &lt;!--      Section to specify specific solution information            Name = Name of the solution       Remove = Remove the solution after retraction      RetractAll = Retract from all content applications      --&gt;      &lt;Solution Name="MSFTPlayground.SharePoint.wsp" Remove="true" RetractAll="true"&gt;        &lt;WebApplication ID="1" /&gt;        &lt;WebApplication ID="2" /&gt;        &lt;WebApplication ID="3" /&gt;      &lt;/Solution&gt;    &lt;/Retract&gt;  &lt;/Solutions&gt;&lt;/Configuration&gt;In the configuration file you can specify which solution package you would like to deploy and to what web application. The web applications are specified in the “Environment” section. The configuration file contains a “Environment” section to be able to use the same mechanism for multiple environments that use different URLs. Within the solution section we then refer to a specific web application by its ID.To make it more complex we also added some other properties (Upgrade, DeployToAll) to make the components more advanced.PowerShellWith the configuration file we can start writing the PowerShell that will read out the configuration file and deploys the solution.param(    [string]$filename = $(throw "Specify the Config filename that is located in the drop folder"),    [string]$environment = $(throw "Specify the Environment you would like to deploy to."))'>
    <meta itemprop="datePublished" content="2015-01-09T14:39:02+01:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Create a custom component to deploy SharePoint Solutions – Part 2
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>In the <a href="http://msftplayground.com/2014/10/customize-the-release-management-build-template-part-1/" target="_blank" rel="noopener noreferrer">first part of the series</a> we have adjusted a build template in order to copy content from source control to the drop location after the build. This content can then be used to supply release management with information about the deployment. This functionality will be used to copy a configuration file to the drop location. With PowerShell were our custom component will exist off we can read out that configuration file.</p>
<p>As you can read we will create our custom component in specific steps and we will start with the configuration file.</p>
<h1> Configuration File</h1>
<p>The configuration file will contain all of the information that is needed to deploy a SharePoint solution package. As example you would like to know to which web application the solution needs to be deployed to.</p>
<p>As example take a look at the following sample configuration file:</p>
<pre class="highlight">&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;!-- 
  Section to specify the configuration for the deployment
--&gt;
&lt;Configuration&gt;
  &lt;!--
    Section to specify environment information
  --&gt;
  &lt;Environment&gt;
    &lt;DEV&gt;
      &lt;WebApplications&gt;
        &lt;WebApplication ID="1" Url="http://sample.msftplayground.local"&gt;&lt;/WebApplication&gt;
      &lt;/WebApplications&gt;
    &lt;/DEV&gt;
    &lt;TST&gt;
      &lt;WebApplications&gt;
        &lt;WebApplication ID="1" Url="http://sample-tst.msftplayground.local"&gt;&lt;/WebApplication&gt;
      &lt;/WebApplications&gt;
    &lt;/TST&gt;
    &lt;ACC&gt;
      &lt;WebApplications&gt;
        &lt;WebApplication ID="1" Url="http://sample-acc.msftplayground.local"&gt;&lt;/WebApplication&gt;
      &lt;/WebApplications&gt;
    &lt;/ACC&gt;
    &lt;PROD&gt;
      &lt;WebApplications&gt;
        &lt;WebApplication ID="1" Url="http://sample.msftplayground.local"&gt;&lt;/WebApplication&gt;
      &lt;/WebApplications&gt;
    &lt;/PROD&gt;
  &lt;/Environment&gt;
  &lt;!--
    Section to specify information on solutions were to deploy to or retract.
    --&gt;
  &lt;Solutions&gt;
    &lt;!--
    Section to specify the solutions that need to deployed.
    --&gt;
    &lt;Deploy&gt;
      &lt;!--
      Section to specify specific solution information
      
      Name = Name of the solution 
      Upgrade = Upgrade the solution if it exists
      DeployToAll = Deploy to all content applications
      DeployNotExits = Deploy the solution if it does not exist when upgrade is set to true
      WebApplication = The web application to deploy to specified with the ID when deploy to all is false
      --&gt;
      &lt;Solution Name="MSFTPlayground.SharePoint.wsp" Upgrade="true" DeployToAll="false" DeployNotExists="true"&gt;
        &lt;WebApplication ID="1" /&gt;
        &lt;WebApplication ID="2" /&gt;
        &lt;WebApplication ID="3" /&gt;
      &lt;/Solution&gt;
    &lt;/Deploy&gt;
    &lt;Retract&gt;
      &lt;!--
      Section to specify specific solution information
      
      Name = Name of the solution 
      Remove = Remove the solution after retraction
      RetractAll = Retract from all content applications
      --&gt;
      &lt;Solution Name="MSFTPlayground.SharePoint.wsp" Remove="true" RetractAll="true"&gt;
        &lt;WebApplication ID="1" /&gt;
        &lt;WebApplication ID="2" /&gt;
        &lt;WebApplication ID="3" /&gt;
      &lt;/Solution&gt;
    &lt;/Retract&gt;
  &lt;/Solutions&gt;
&lt;/Configuration&gt;
</pre>
<p>In the configuration file you can specify which solution package you would like to deploy and to what web application. The web applications are specified in the “Environment” section. The configuration file contains a “Environment” section to be able to use the same mechanism for multiple environments that use different URLs. Within the solution section we then refer to a specific web application by its ID.</p>
<p>To make it more complex we also added some other properties (Upgrade, DeployToAll) to make the components more advanced.</p>
<h1>PowerShell</h1>
<p>With the configuration file we can start writing the PowerShell that will read out the configuration file and deploys the solution.</p>
<pre class="highlight">param(
    [string]$filename = $(throw "Specify the Config filename that is located in the drop folder"),
    [string]$environment = $(throw "Specify the Environment you would like to deploy to.")
)

if ((Get-PSSnapin "Microsoft.SharePoint.PowerShell" -ErrorAction SilentlyContinue) -eq $null) {
    Write-Host "Loading Microsoft SharePoint PowerShell" -ForegroundColor Green
    Add-PSSnapin "Microsoft.SharePoint.PowerShell"
}
Write-Host "#### Start deploying solutions ####"

if ((Test-Path $fileName) -eq $true) {
    . ".\functions.ps1"
    Write-Host "Loading configuration file $filename" -ForegroundColor Green

    try{
        $config = [xml] (Get-Content $fileName)
        Deploy-Solutions
    }catch{
        Write-Host $_.Exception.Message -ForegroundColor Red
        throw "Exception occured while deploying solutions"
    }
}else {
    throw "Error loading configuration file, exiting the deployment"
}

Write-Host "#### End deploying solutions ####"
</pre>
<p>This PowerShell file needs to be run with two parameters:</p>
<ul>
<li>
<strong>Filename: </strong>The path to the configuration file in the drop location.</li>
<li>
<strong>Environment: </strong>The environment you would like to deploy to. This should be the same as the environment section you have specified in the configuration file.</li>
</ul>
<p>Within the PowerShell file the SharePoint PowerShell module is loaded and besides that I load a custom functions file. In the functions file I have a couple of PowerShell methods that I use to do some advanced stuff on the configuration file, and also some more SharePoint functions. When everything is loaded the configuration file is loaded in the  config variable and we call the function “Deploy-Solutions” that is within the same file.</p>
<pre class="highlight">function Deploy-Solutions(){
    $path = ".\";
    $type = "Deploy";

    foreach($solution in $config.Configuration.Solutions.Deploy.Solution){
        
        $solutionName =  $solution.Name;
        $currentDirectory = Get-Location
        $solutionPath = [IO.Path]::GetFullPath([String]::Concat($currentDirectory, "\" ,$path, "\", $solutionName))    
        Write-Host " &gt; Solution path is '$solutionPath'" -ForegroundColor Yellow

        $webApplicationScoped = Get-SolutionProperty $solutionName "ContainsWebApplicationResource"
        $solutionDeployed = Get-SolutionProperty $solutionName "Deployed"
                               
        [bool]$deployToAll = Check-SolutionConfigProperty $solutionName "DeployToAll" $type
        [bool]$upgrade = Check-SolutionConfigProperty $solutionName "Upgrade" $type
        [bool]$deployNotExists = Check-SolutionConfigProperty $solutionName "DeployNotExists" $type
        $webApps = Get-WebAppsForSolution $solutionName $environment $type

        # Check if file exists
        if ((Test-Path $solutionPath) -eq $false) {
            Write-Host " &gt; Solution file doesn't exist!" -ForeGroundColor Red
            throw "Solution file doesn't exist!";
        }
        $deploySolution = $false;

        if (Check-SolutionExists $solutionName) {
            Write-Host " &gt; Solution exists in solution store" -ForegroundColor Yellow
            if(!$upgrade){
                Write-Host " &gt; Solution exists in solution store" -ForegroundColor Yellow
                                               
                if($solutionDeployed) {
                    Write-Host " &gt; Solution is deployed, uninstall solution $solutionName" -ForegroundColor Yellow
                    if ($webApplicationScoped) {
                        $solution = Get-SPSolution $solutionName
                        $deployedTo = $solution.DeployedWebApplications

                        foreach ($webApp in $deployedTo) {
                            Write-Host " &gt; Uninstall from web application '$webApp'" -ForeGroundColor Yellow
                            Uninstall-SPSolution -Identity $solutionName -WebApplication $webApp -Confirm:$false  -ErrorAction Stop
                            Wait-ForJobToFinish($solutionName)
                        }                                                    
                    } else {
                        Write-Host " &gt; Solution doesn't contain web application resource, uninstall globally." -ForeGroundColor Yellow
                        Uninstall-SPSolution -Identity $solutionName -Confirm:$false -ErrorAction Stop
                        Wait-ForJobToFinish($solutionName)
                    }
                    Write-Host " &gt; Solution uninstalled" -ForeGroundColor Green
                }
                Write-Host " &gt; Remove solution $solutionName from solution store" -ForeGroundColor Yellow
                Remove-SPSolution -Identity $solutionName -Confirm:$false -ErrorAction Stop
                Write-Host " &gt; Solution removed" -ForeGroundColor Green        
                $deploySolution = $true                          
            }else{
                Write-Host " &gt; Upgrade SPSolution $solutionName" -ForegroundColor Yellow
                Update-SPSolution -LiteralPath $solutionPath -Identity $solutionName -Force -GACDeployment -ErrorAction Stop       
                Wait-ForJobToFinish($solutionName)                
                $deploySolution = $false
            }

            
        }else{
            Write-Host " &gt; Solution does not exists in solution store" -ForegroundColor Yellow

            if(($upgrade -And $deployNotExists)){
                Write-Host " &gt; Solution does not exists and will be added because it needed to be deployed when it did not exists"  -ForegroundColor Yellow
                $deploySolution = $true
            }

            if(!($upgrade)){
                Write-Host " &gt; Solution does not exists and will be added in order to deploy"  -ForegroundColor Yellow
                $deploySolution = $true
            }
        }
        
        if($deploySolution){
            Write-Host " &gt; Add solution $solutionName to solution store" -ForeGroundColor Yellow
            Add-SPSolution -LiteralPath $solutionPath -ErrorAction Stop
            Write-Host " &gt; Solution added" -ForeGroundColor Green

            Write-Host " &gt; Deploy solution $solutionName" -ForeGroundColor Yellow
            $webApplicationScoped = Get-SolutionProperty $solutionName "ContainsWebApplicationResource"

            if ($webApplicationScoped) {
                if ($deployToAll) {
                    Write-Host " &gt; Deploying to all Web Applications" -ForeGroundColor Yellow
                    Install-SPSolution –Identity $solutionName -GACDeployment -AllWebApplications -Force -ErrorAction Stop
                    Wait-ForJobToFinish($solutionName)
                } else {
                    foreach ($webApp in $webApps) {
                        Write-Host " &gt; Deploying to $webApp" -ForeGroundColor Yellow                                                          
                        Install-SPSolution –Identity $solutionName -WebApplication $webApp -Force -GACDeployment -ErrorAction Stop
                        Wait-ForJobToFinish($solutionName)
                    }
                }
            } else {
                Install-SPSolution –Identity $solutionName -GACDeployment -Force -ErrorAction Stop
                Wait-ForJobToFinish($solutionName)
            }
        }

        $success = Get-SPSolutionSuccessState $solutionName

            if($success){
                Write-Host " &gt; Solution $solutionName installed" -ForeGroundColor Green
            }
            else{
               Write-Host " &gt; Solution $solutionName could not be installed correctly." -ForeGroundColor Green
               throw "Error occured while installing solution $solutionName"
            }
    }                          
}
</pre>
<p>In the Deploy-Solution function we navigate trough the xml and deploy the solution packages specified in the configuration file. Within the Deploy-Solution function we also use some functions that are specified in the functions.ps1 file.</p>
<p>With the PowerShell files in place we can start adding things to Release Management. The first action in Release Management is creating a new Tool. By going to “Inventory” – “Tools”  and click “New” to create a new tool.</p>
<p><a href="http://msftplayground.com/wp-content/uploads/2015/01/ReleaseManagement-New-Tool.jpg" target="_blank" rel="noopener noreferrer"><img style="background-image: none; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border: 0px;" title="ReleaseManagement-New-Tool" src="/assets/archive/2015/01/ReleaseManagement-New-Tool_thumb.jpg" alt="ReleaseManagement-New-Tool" width="333" height="173" border="0"></a></p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#component" class="page__taxonomy-item" rel="tag">Component</a><span class="sep">, </span>
    
      <a href="/tags/#deployment" class="page__taxonomy-item" rel="tag">Deployment</a><span class="sep">, </span>
    
      <a href="/tags/#powershell" class="page__taxonomy-item" rel="tag">Powershell</a><span class="sep">, </span>
    
      <a href="/tags/#release-management" class="page__taxonomy-item" rel="tag">Release Management</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#development" class="page__taxonomy-item" rel="tag">Development</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2015-01-09T14:39:02+01:00">January 9, 2015</time></p>


      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?via=maikvandergaag&amp;text=Create+a+custom+component+to+deploy+SharePoint+Solutions+%26ndash%3B+Part+2%20http%3A%2F%2Flocalhost%3A4000%2F2015%2F01%2Fcreate-custom-component-deploy-sharepoint-solutions-part-2%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter" target="_blank" rel="noopener noreferrer"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2F2015%2F01%2Fcreate-custom-component-deploy-sharepoint-solutions-part-2%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook" target="_blank" rel="noopener noreferrer"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A%2F%2Flocalhost%3A4000%2F2015%2F01%2Fcreate-custom-component-deploy-sharepoint-solutions-part-2%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn" target="_blank" rel="noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/2014/11/article-published-diwug-magazine-14-management-of-host-named-site-collections/" class="pagination--pager" title="Article Published DIWUG Magazine 14 – Management of Host Named Site Collections
">Previous</a>
    
    
      <a href="/2015/01/creating-the-release-template-that-runs-after-the-build-part-3/" class="pagination--pager" title="Creating the Release Template that runs after the Build – Part 3
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2023/05/creating-a-logic-app-api-connection-that-uses-the-managed-identity-using-bicep/" rel="permalink">Creating a Logic App API Connection that uses the Managed Identity using Bicep
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Logic Apps in Azure provides a platform for building workflows that integrate with various services and APIs. When creating Logic Apps, you must often connec...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2023/03/unlocking-the-power-of-azure-app-registrations-a-guide-to-exposing-your-app-as-an-api-with-user-assignments-required-turned-on/" rel="permalink">“Exposing Azure App Registrations as Secure APIs: A Guide to Authentication with ‘User Assignments Required’ Turned On”
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Azure App Registrations are a powerful tool for managing resource access and integrating applications with Microsoft's cloud services. While these registrati...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2022/12/centrally-manage-your-app-configurations/" rel="permalink">Centrally manage your App Configurations
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          10 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">The application landscape in Azure has grown significantly in recent years, with a wide range of tools and services available to help businesses build, deplo...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2022/10/shift-left-security-with-microsoft-security-devops-msdo/" rel="permalink">Shift Left Security with Microsoft Security DevOps (MSDO)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">With the new capabilities released add Ignite, you are now even more capable of shifting security checks further to the left. In this article, I explain how ...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap">
<form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term...">
  </form>
  <div id="results" class="results"></div>
</div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <script src="/assets/scripts/sidebarcontent.js"></script>
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/maikvandergaag" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/maikvandergaag" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/maikvandergaag/" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> Linkedin</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">© 2023 Maik van der Gaag. Powered by <a href="https://jekyllrb.com" rel="nofollow noopener noreferrer" target="_blank">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow noopener noreferrer" target="_blank">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
