<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Feature for adding a Icon to your SharePoint farm - Microsoft Playground</title>
<meta name="description" content="On the internet you can find several articles about how to add an icon to the SharePoint farm.. Microsoft also has a KB article that describes how you can accomplish it.  http://support.microsoft.com/default.aspx/kb/837849  The steps that have to be taken to add the a icon are (example with a pdf icon):  Copy the .gif file that you want to use for the icon to the following folder on the server:Drive:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\60\Template\Images   Edit the Docicon.xml file to include the .pdf file name extension. To do so:a. Start Notepad, and then open the Docicon.xml file. The Docicon.xml file is located in one of the following folders on the server: Drive:\Program Files\Common Files\Microsoft Shared\Web server extensions\12\Template\Xml b. In the section of the Docicon.xml file, add an entry for the .pdf file name extension. To do so, add the following line, where NameofIconFile is the name of the .gif file:  &lt;Mapping Key=&quot;pdf&quot; Value=&quot;NameofIconFile.gif&quot; /&gt;  Restart Microsoft Internet Information Services (IIS).  Reading those articles I thought by myself that there must be a way to take these steps without manually editing the files within the 12 hive. To accomplish you have to create a wsp package that exists out of an image and a feature. The feature will have a receiver that kicks off a timer job. The timer job will add or delete the mapping section depending on the activation or deactivation of the feature. The feature.xml will have to look something like this and has to have a scope of farm because you will change a file that is used by the complete farm.: &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;Feature Id=&quot;5dfefa72-4a9b-4320-af45-03758c755079&quot;          Title=&quot;motion10 PDF Integration&quot;          Description=&quot;This feature will add the pdf icon to the farm.&quot;          Version=&quot;12.0.0.0&quot;          Hidden=&quot;FALSE&quot;          Scope=&quot;Farm&quot;          DefaultResourceFile=&quot;core&quot;          ReceiverAssembly=&quot;Motion10.SharePoint.IconIntegration, Version=1.0.0.0, Culture=neutral, PublicKeyToken=d7298385728e744a&quot; ReceiverClass=&quot;Motion10.SharePoint.IconIntegration.IconIntegration&quot; xmlns=&quot;http://schemas.microsoft.com/sharepoint/&quot;          Creator=&quot;Maik van der Gaag&quot;          ImageUrl=&quot;motion10/FeaturesIcon.png&quot;          ImageUrlAltText=&quot;http://www.motion10.com&quot;&gt;  &lt;Properties&gt;      &lt;Property Key=&quot;IconExtension&quot; Value=&quot;pdf&quot;/&gt;       &lt;Property Key=&quot;IconUrl&quot; Value=&quot;pdf_icon.png&quot;/&gt;  &lt;/Properties&gt;  &lt;/Feature&gt; In the feature.xml file I defined two properties with these properties we create the mapping element in the docicon.xml file. Note: This feature can be used to add all kinds of different icons to the farm. If you would like to add another icon you have to edit the two properties. Like we discussed the feature will have a receiver that kicks of the timer job. To accomplish this we have to implement the FeatureActivated and FeatureDeactivating. On the activation we will start the timer job to add the mapping and on the deactivation we will delete it.  using System;  using Microsoft.SharePoint;  using Microsoft.SharePoint.Administration;">


  <meta name="author" content="Maik van der Gaag">
  
  <meta property="article:author" content="Maik van der Gaag">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Microsoft Playground">
<meta property="og:title" content="Feature for adding a Icon to your SharePoint farm">
<meta property="og:url" content="http://localhost:4000/2009/06/feature-for-adding-a-icon-to-your-sharepoint-farm/">


  <meta property="og:description" content="On the internet you can find several articles about how to add an icon to the SharePoint farm.. Microsoft also has a KB article that describes how you can accomplish it.  http://support.microsoft.com/default.aspx/kb/837849  The steps that have to be taken to add the a icon are (example with a pdf icon):  Copy the .gif file that you want to use for the icon to the following folder on the server:Drive:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\60\Template\Images   Edit the Docicon.xml file to include the .pdf file name extension. To do so:a. Start Notepad, and then open the Docicon.xml file. The Docicon.xml file is located in one of the following folders on the server: Drive:\Program Files\Common Files\Microsoft Shared\Web server extensions\12\Template\Xml b. In the section of the Docicon.xml file, add an entry for the .pdf file name extension. To do so, add the following line, where NameofIconFile is the name of the .gif file:  &lt;Mapping Key=&quot;pdf&quot; Value=&quot;NameofIconFile.gif&quot; /&gt;  Restart Microsoft Internet Information Services (IIS).  Reading those articles I thought by myself that there must be a way to take these steps without manually editing the files within the 12 hive. To accomplish you have to create a wsp package that exists out of an image and a feature. The feature will have a receiver that kicks off a timer job. The timer job will add or delete the mapping section depending on the activation or deactivation of the feature. The feature.xml will have to look something like this and has to have a scope of farm because you will change a file that is used by the complete farm.: &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;Feature Id=&quot;5dfefa72-4a9b-4320-af45-03758c755079&quot;          Title=&quot;motion10 PDF Integration&quot;          Description=&quot;This feature will add the pdf icon to the farm.&quot;          Version=&quot;12.0.0.0&quot;          Hidden=&quot;FALSE&quot;          Scope=&quot;Farm&quot;          DefaultResourceFile=&quot;core&quot;          ReceiverAssembly=&quot;Motion10.SharePoint.IconIntegration, Version=1.0.0.0, Culture=neutral, PublicKeyToken=d7298385728e744a&quot; ReceiverClass=&quot;Motion10.SharePoint.IconIntegration.IconIntegration&quot; xmlns=&quot;http://schemas.microsoft.com/sharepoint/&quot;          Creator=&quot;Maik van der Gaag&quot;          ImageUrl=&quot;motion10/FeaturesIcon.png&quot;          ImageUrlAltText=&quot;http://www.motion10.com&quot;&gt;  &lt;Properties&gt;      &lt;Property Key=&quot;IconExtension&quot; Value=&quot;pdf&quot;/&gt;       &lt;Property Key=&quot;IconUrl&quot; Value=&quot;pdf_icon.png&quot;/&gt;  &lt;/Properties&gt;  &lt;/Feature&gt; In the feature.xml file I defined two properties with these properties we create the mapping element in the docicon.xml file. Note: This feature can be used to add all kinds of different icons to the farm. If you would like to add another icon you have to edit the two properties. Like we discussed the feature will have a receiver that kicks of the timer job. To accomplish this we have to implement the FeatureActivated and FeatureDeactivating. On the activation we will start the timer job to add the mapping and on the deactivation we will delete it.  using System;  using Microsoft.SharePoint;  using Microsoft.SharePoint.Administration;">



  <meta property="og:image" content="http://localhost:4000/assets/profile/profile.png">



  <meta name="twitter:site" content="@maikvandergaag">
  <meta name="twitter:title" content="Feature for adding a Icon to your SharePoint farm">
  <meta name="twitter:description" content="On the internet you can find several articles about how to add an icon to the SharePoint farm.. Microsoft also has a KB article that describes how you can accomplish it.  http://support.microsoft.com/default.aspx/kb/837849  The steps that have to be taken to add the a icon are (example with a pdf icon):  Copy the .gif file that you want to use for the icon to the following folder on the server:Drive:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\60\Template\Images   Edit the Docicon.xml file to include the .pdf file name extension. To do so:a. Start Notepad, and then open the Docicon.xml file. The Docicon.xml file is located in one of the following folders on the server: Drive:\Program Files\Common Files\Microsoft Shared\Web server extensions\12\Template\Xml b. In the section of the Docicon.xml file, add an entry for the .pdf file name extension. To do so, add the following line, where NameofIconFile is the name of the .gif file:  &lt;Mapping Key=&quot;pdf&quot; Value=&quot;NameofIconFile.gif&quot; /&gt;  Restart Microsoft Internet Information Services (IIS).  Reading those articles I thought by myself that there must be a way to take these steps without manually editing the files within the 12 hive. To accomplish you have to create a wsp package that exists out of an image and a feature. The feature will have a receiver that kicks off a timer job. The timer job will add or delete the mapping section depending on the activation or deactivation of the feature. The feature.xml will have to look something like this and has to have a scope of farm because you will change a file that is used by the complete farm.: &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;Feature Id=&quot;5dfefa72-4a9b-4320-af45-03758c755079&quot;          Title=&quot;motion10 PDF Integration&quot;          Description=&quot;This feature will add the pdf icon to the farm.&quot;          Version=&quot;12.0.0.0&quot;          Hidden=&quot;FALSE&quot;          Scope=&quot;Farm&quot;          DefaultResourceFile=&quot;core&quot;          ReceiverAssembly=&quot;Motion10.SharePoint.IconIntegration, Version=1.0.0.0, Culture=neutral, PublicKeyToken=d7298385728e744a&quot; ReceiverClass=&quot;Motion10.SharePoint.IconIntegration.IconIntegration&quot; xmlns=&quot;http://schemas.microsoft.com/sharepoint/&quot;          Creator=&quot;Maik van der Gaag&quot;          ImageUrl=&quot;motion10/FeaturesIcon.png&quot;          ImageUrlAltText=&quot;http://www.motion10.com&quot;&gt;  &lt;Properties&gt;      &lt;Property Key=&quot;IconExtension&quot; Value=&quot;pdf&quot;/&gt;       &lt;Property Key=&quot;IconUrl&quot; Value=&quot;pdf_icon.png&quot;/&gt;  &lt;/Properties&gt;  &lt;/Feature&gt; In the feature.xml file I defined two properties with these properties we create the mapping element in the docicon.xml file. Note: This feature can be used to add all kinds of different icons to the farm. If you would like to add another icon you have to edit the two properties. Like we discussed the feature will have a receiver that kicks of the timer job. To accomplish this we have to implement the FeatureActivated and FeatureDeactivating. On the activation we will start the timer job to add the mapping and on the deactivation we will delete it.  using System;  using Microsoft.SharePoint;  using Microsoft.SharePoint.Administration;">
  <meta name="twitter:url" content="http://localhost:4000/2009/06/feature-for-adding-a-icon-to-your-sharepoint-farm/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="http://localhost:4000/assets/profile/profile.png">
    
  

  



  <meta property="article:published_time" content="2009-06-25T06:51:00+02:00">






<link rel="canonical" href="http://localhost:4000/2009/06/feature-for-adding-a-icon-to-your-sharepoint-farm/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Maik van der Gaag",
      "url": "http://localhost:4000/",
      "sameAs": ["https://twitter.com/maikvandergaag","https://github.com/maikvandergaag"]
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Microsoft Playground Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<link rel="stylesheet" href="/assets/css/custom.css">

<!-- You can set your favicon here -->
<link rel="icon" type="image/png" sizes="32x32" href="/favicon.png">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Microsoft Playground
          <span class="site-subtitle">debug.write('Architecture, Azure, Azure DevOps, Git, GitHub, DevOps');</span>
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/about">About</a>
            </li>
<li class="masthead__menu-item">
              <a href="/extensions">Extensions</a>
            </li>
<li class="masthead__menu-item">
              <a href="/speaking">Speaking</a>
            </li>
<li class="masthead__menu-item">
              <a href="/year-archive">Posts</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories">Categories</a>
            </li>
</ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/profile/profile.png" alt="Maik van der Gaag" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Maik van der Gaag</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>I am <strong>Microsoft Azure MVP</strong>, <strong>Speaker</strong> and <strong>Father</strong>.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Schiedam, The Netherlands</span>
        </li>
      

      
        
          
            <li><a href="https://twitter.com/maikvandergaag" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/maikvandergaag" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/maikvandergaag/" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">Linkedin</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Feature for adding a Icon to your SharePoint farm">
    <meta itemprop="description" content='On the internet you can find several articles about how to add an icon to the SharePoint farm.. Microsoft also has a KB article that describes how you can accomplish it.http://support.microsoft.com/default.aspx/kb/837849The steps that have to be taken to add the a icon are (example with a pdf icon):Copy the .gif file that you want to use for the icon to the following folder on the server:Drive:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\60\Template\Images  Edit the Docicon.xml file to include the .pdf file name extension. To do so:a. Start Notepad, and then open the Docicon.xml file. The Docicon.xml file is located in one of the following folders on the server: Drive:\Program Files\Common Files\Microsoft Shared\Web server extensions\12\Template\Xml b. In the section of the Docicon.xml file, add an entry for the .pdf file name extension. To do so, add the following line, where NameofIconFile is the name of the .gif file:&lt;Mapping Key="pdf" Value="NameofIconFile.gif" /&gt;Restart Microsoft Internet Information Services (IIS).Reading those articles I thought by myself that there must be a way to take these steps without manually editing the files within the 12 hive. To accomplish you have to create a wsp package that exists out of an image and a feature. The feature will have a receiver that kicks off a timer job. The timer job will add or delete the mapping section depending on the activation or deactivation of the feature. The feature.xml will have to look something like this and has to have a scope of farm because you will change a file that is used by the complete farm.:&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;Feature Id="5dfefa72-4a9b-4320-af45-03758c755079"         Title="motion10 PDF Integration"         Description="This feature will add the pdf icon to the farm."         Version="12.0.0.0"         Hidden="FALSE"         Scope="Farm"         DefaultResourceFile="core"         ReceiverAssembly="Motion10.SharePoint.IconIntegration, Version=1.0.0.0, Culture=neutral, PublicKeyToken=d7298385728e744a" ReceiverClass="Motion10.SharePoint.IconIntegration.IconIntegration" xmlns="http://schemas.microsoft.com/sharepoint/"         Creator="Maik van der Gaag"         ImageUrl="motion10/FeaturesIcon.png"         ImageUrlAltText="http://www.motion10.com"&gt; &lt;Properties&gt;     &lt;Property Key="IconExtension" Value="pdf"/&gt;      &lt;Property Key="IconUrl" Value="pdf_icon.png"/&gt; &lt;/Properties&gt; &lt;/Feature&gt;In the feature.xml file I defined two properties with these properties we create the mapping element in the docicon.xml file. Note: This feature can be used to add all kinds of different icons to the farm. If you would like to add another icon you have to edit the two properties. Like we discussed the feature will have a receiver that kicks of the timer job. To accomplish this we have to implement the FeatureActivated and FeatureDeactivating. On the activation we will start the timer job to add the mapping and on the deactivation we will delete it. using System; using Microsoft.SharePoint; using Microsoft.SharePoint.Administration;'>
    <meta itemprop="datePublished" content="2009-06-25T06:51:00+02:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Feature for adding a Icon to your SharePoint farm
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <div class="ExternalClassA4B9EF6512634BE5A3627489929E1524">On the internet you can find several articles about how to add an icon to the SharePoint farm.. Microsoft also has a KB article that describes how you can accomplish it.
<ul>
<li><a href="http://support.microsoft.com/default.aspx/kb/837849" target="_blank" rel="noopener noreferrer">http://support.microsoft.com/default.aspx/kb/837849</a></li>
</ul>
<p>The steps that have to be taken to add the a icon are (example with a pdf icon):
</p>
<ul>
<li>Copy the .gif file that you want to use for the icon to the following folder on the server:Drive:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\60\Template\Images  </li>
<li>Edit the Docicon.xml file to include the .pdf file name extension. To do so:a. Start Notepad, and then open the Docicon.xml file. The Docicon.xml file is located in one of the following folders on the server: Drive:\Program Files\Common Files\Microsoft Shared\Web server extensions\12\Template\Xml b. In the section of the Docicon.xml file, add an entry for the .pdf file name extension. To do so, add the following line, where NameofIconFile is the name of the .gif file:</li>
</ul>
<pre class="highlight">&lt;Mapping Key="pdf" Value="NameofIconFile.gif" /&gt;</pre>
<ul>
<li>Restart Microsoft Internet Information Services (IIS).</li>
</ul>
<p>Reading those articles I thought by myself that there must be a way to take these steps without manually editing the files within the 12 hive. To accomplish you have to create a wsp package that exists out of an image and a feature. The feature will have a receiver that kicks off a timer job. The timer job will add or delete the mapping section depending on the activation or deactivation of the feature. The feature.xml will have to look something like this and has to have a scope of farm because you will change a file that is used by the complete farm.:</p>
<pre class="highlight">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;Feature Id="5dfefa72-4a9b-4320-af45-03758c755079"
         Title="motion10 PDF Integration"
         Description="This feature will add the pdf icon to the farm."
         Version="12.0.0.0"
         Hidden="FALSE"
         Scope="Farm"
         DefaultResourceFile="core"
         ReceiverAssembly="Motion10.SharePoint.IconIntegration, Version=1.0.0.0, Culture=neutral, PublicKeyToken=d7298385728e744a" ReceiverClass="Motion10.SharePoint.IconIntegration.IconIntegration" xmlns="http://schemas.microsoft.com/sharepoint/"
         Creator="Maik van der Gaag"
         ImageUrl="motion10/FeaturesIcon.png"
         ImageUrlAltText="http://www.motion10.com"&gt;
 &lt;Properties&gt;
     &lt;Property Key="IconExtension" Value="pdf"/&gt; 
     &lt;Property Key="IconUrl" Value="pdf_icon.png"/&gt;
 &lt;/Properties&gt; 
&lt;/Feature&gt;</pre>
<p>In the feature.xml file I defined two properties with these properties we create the mapping element in the docicon.xml file. <em><strong>Note: </strong>This feature can be used to add all kinds of different icons to the farm. If you would like to add another icon you have to edit the two properties.</em> Like we discussed the feature will have a receiver that kicks of the timer job. To accomplish this we have to implement the FeatureActivated and FeatureDeactivating. On the activation we will start the timer job to add the mapping and on the deactivation we will delete it.</p>
<pre class="highlight"> using System;
 using Microsoft.SharePoint;
 using Microsoft.SharePoint.Administration;

 namespace Motion10.SharePoint.IconIntegration
 {
     class IconIntegration: SPFeatureReceiver
     {
         /// &lt;summary&gt;
         /// The name of the WSS Administration service
         /// &lt;/summary&gt;
         private static readonly string serviceName = "WSS_Administration";

         public override void FeatureActivated(SPFeatureReceiverProperties properties)
         {
             RunJobNow(false, properties);
         }

         public override void FeatureDeactivating(SPFeatureReceiverProperties properties)
         {
             RunJobNow(true, properties);
         }

         public override void FeatureInstalled(SPFeatureReceiverProperties properties)
         {
         }

         public override void FeatureUninstalling(SPFeatureReceiverProperties properties)
         {
         }

         private void RunJobNow(bool delete, SPFeatureReceiverProperties prop)
         {
            if (prop == null)
             {
                 throw new ArgumentNullException("prop", "Argument 'prop' cannot be 'null'");
             }

             SPFarm farm = prop.Definition.Farm;

             InstallIconTimerJob newJob = null;

             foreach (SPService service in farm.Services)
             {
                 if (service.Name == serviceName)
                 {

                     newJob = new InstallIconTimerJob(service, prop.Definition.Id, delete);

                     SPJobDefinition def = service.GetJobDefinitionByName(newJob.Name);
                     if (def != null)
                     {
                         def.Delete();
                     }

                     break;
                 }
             }

             newJob.Schedule = new SPOneTimeSchedule(DateTime.Now.AddHours(-2.0));
             newJob.Title = string.Format("{0} {1} Icon for Feature {2}", delete ? "Delete" : "Install", prop.Definition.Properties["IconExtension"], prop.Definition.Id);
             newJob.Update();
         }
     }
 }</pre>
<p>In the RunJobNow() method we create a new instance of our timer job by creating it with two properties. These properties are our feature id and a boolean whether we want to delete the mapping or add it. We also created an extension method on the SPService for retrieving a job definition by name. Here we will retrieve our own job definition if it is available and delete it if it is because we can’t create a new instance of the timer job when it is already available.</p>
<pre class="highlight">using System;
 using System.Linq;
 using Microsoft.SharePoint.Administration;

 namespace Motion10.SharePoint.IconIntegration{
     /// &lt;summary&gt;
     /// SPService extension methods
     /// &lt;/summary&gt;
     public static class SPServiceExtensions {

         /// &lt;summary&gt;;
         /// Gets the jobdefintions by name.
         /// &lt;/summary&gt;;
         /// &lt;param name="service"&gt;The service&lt;/param&gt;;
         /// &lt;param name="name"&gt;The name.&lt;/param&gt;
         /// &lt;returns&gt;SPJobDefinition&lt;/returns&gt;;
         /// &lt;exception cref="System.ArgumentNullException"&gt;Exception is thrown when the service or name equal null&lt;/exception&gt;
         public static SPJobDefinition GetJobDefinitionByName(this SPService service, string name) {
             if (service == null) {
                 throw new ArgumentNullException("service", "Argument 'service' cannot be 'null'");
             }

             if (String.IsNullOrEmpty(name)) {
                 throw new ArgumentNullException(&amp;quot;name&amp;quot;, &amp;quot;Argument 'name' cannot be 'null' or 'String.Empty'&amp;quot;);
             }

             var query = from SPJobDefinition job in service.JobDefinitions
                         where job.Name == name
                         select job;

             return query.FirstOrDefault();
         }
     }
 }</pre>
<p>Now that the feature is finished we can create the timer job (if you want to read more about the creation of a timer job you can read the following article <a href="http://msdn.microsoft.com/en-us/library/cc406686.aspx" target="_blank" rel="noopener noreferrer">http://msdn.microsoft.com/en-us/library/cc406686.aspx</a>). The timer job will have five properties. </p>
<pre class="highlight">  private bool _delete
         {
             get
             {
                 if (this.Properties.ContainsKey(deleteKey))
                 {
                     return Convert.ToBoolean(this.Properties[deleteKey]);
                 }
                 else
                 {
                     return false;
                 }
             }
             set
             {
                 if (this.Properties.ContainsKey(deleteKey))
                 {
                     this.Properties[deleteKey] = value.ToString();
                 }
                 else
                 {
                     this.Properties.Add(deleteKey, value.ToString());
                 }
             }
         }

         private Guid _featureID
         {
             get
             {
                 if (this.Properties.ContainsKey(featureKey))
                 {
                     return new Guid(this.Properties[featureKey].ToString());
                 }
                 else
                 {
                     return Guid.Empty;
                 }
             }
             set
             {
                 if (this.Properties.ContainsKey(featureKey))
                 {
                     this.Properties[featureKey] = value.ToString();
                 }
                 else
                 {
                     this.Properties.Add(featureKey, value.ToString());
                 }
             }

         }

         private string IconExtension
         {
             get
             {
                 SPFeatureDefinition def = Farm.FeatureDefinitions[_featureID];
                 return def.Properties["IconExtension"].Value;
             }
         }

         private string IconUrl
         {
             get
             {
                 SPFeatureDefinition def = Farm.FeatureDefinitions[_featureID];
                 return def.Properties["IconUrl"].Value;
             }
         }

         public string SPDocIconFile
         {
             get
             {
                 return SPUtility.GetGenericSetupPath(filePath);
             }
         }</pre>
<p>We save the value of the _featureid and _delete property in the property bag of our timer job because we have to access the properties after we created a new instance of the timer job. The other properties will retrieve the attributes for the mapping from the feature definition based on the feature id we saved in the property bag. The SPDocIconFile will create the complete path to the file we need.</p>
<pre class="highlight">using System;
 using System.IO;
 using System.Linq;
 using System.Xml.Linq;
 using Microsoft.SharePoint.Administration;
 using Microsoft.SharePoint.Utilities;
 namespace Motion10.SharePoint.IconIntegration
 {
     public class InstallIconTimerJob : SPJobDefinition
     {
         /// &lt;summary&gt;
         /// Filepath for the spthemes.xml file
         /// &lt;/summary&gt;
         private readonly string filePath = "TEMPLATE\\XML\\DOCICON.XML";
         /// &lt;summary&gt;
         /// The property key for the delete property
         /// &lt;/summary&gt;
         private readonly string deleteKey = "Icon_Installation_Deletekey";
         /// &lt;summary&gt;
         /// The property key for the feature property
         /// &lt;/summary&gt;
         private readonly string featureKey = "Icon_Installation_Featurekey";
         private bool _delete
         {
             get
             {
                 if (this.Properties.ContainsKey(deleteKey))
                 {
                     return Convert.ToBoolean(this.Properties[deleteKey]);
                 }
                 else
                 {
                     return false;
                 }
             }
             set
             {
                 if (this.Properties.ContainsKey(deleteKey))
                 {
                     this.Properties[deleteKey] = value.ToString();
                 }
                 else
                 {
                     this.Properties.Add(deleteKey, value.ToString());
                 }
             }
         }
         private Guid _featureID
         {
             get
             {
                 if (this.Properties.ContainsKey(featureKey))
                 {
                     return new Guid(this.Properties[featureKey].ToString());
                 }
                 else
                 {
                     return Guid.Empty;
                 }
             }
             set
             {
                 if (this.Properties.ContainsKey(featureKey))
                 {
                     this.Properties[featureKey] = value.ToString();
                 }
                 else
                 {
                     this.Properties.Add(featureKey, value.ToString());
                 }
             }
         }
         private string IconExtension
         {
             get
             {
                 SPFeatureDefinition def = Farm.FeatureDefinitions[_featureID];
                 return def.Properties["IconExtension"].Value;
             }
         }
         private string IconUrl
         {
             get
             {
                 SPFeatureDefinition def = Farm.FeatureDefinitions[_featureID];
                 return def.Properties["IconUrl"].Value;
             }
         }
         public string SPDocIconFile
         {
             get
             {
                 return SPUtility.GetGenericSetupPath(filePath);
             }
         }
         public InstallIconTimerJob()
             : base()
         {
         }
         public InstallIconTimerJob(SPService service, Guid featureID, bool delete)
             : base("Icon Installer", service, null, SPJobLockType.None)
         {
             this._delete = delete;
             this._featureID = featureID;
         }
         public override void Execute(Guid targetInstanceId)
         {
             base.Execute(targetInstanceId);
             this.ChangeDocIconFile();
         }
         private void ChangeDocIconFile()
         {
             string spThemesContent = string.Empty;
             if (File.Exists(SPDocIconFile))
             {
                 XDocument doc = XDocument.Load(SPDocIconFile);
                 var element = from b in doc.Element("DocIcons").Element("ByExtension").Elements("Mapping")
                               where b.Attribute("Key").Value.ToLower() == this.IconExtension.ToLower()
                               select b;
                 bool containsElement = (element != null &amp;&amp; element.Count() &gt; 0);
                 if (_delete)
                 {
                     if (containsElement)
                     {
                         element.Remove();
                         doc.Save(SPDocIconFile);
                     }

        
      

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#icon" class="page__taxonomy-item" rel="tag">Icon</a><span class="sep">, </span>
    
      <a href="/tags/#sharepoint" class="page__taxonomy-item" rel="tag">SharePoint</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#development" class="page__taxonomy-item" rel="tag">Development</a><span class="sep">, </span>
    
      <a href="/categories/#sharepoint" class="page__taxonomy-item" rel="tag">SharePoint</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2009-06-25T06:51:00+02:00">June 25, 2009</time></p>


      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?via=maikvandergaag&amp;text=Feature+for+adding+a+Icon+to+your+SharePoint+farm%20http%3A%2F%2Flocalhost%3A4000%2F2009%2F06%2Ffeature-for-adding-a-icon-to-your-sharepoint-farm%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter" target="_blank" rel="noopener noreferrer"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2F2009%2F06%2Ffeature-for-adding-a-icon-to-your-sharepoint-farm%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook" target="_blank" rel="noopener noreferrer"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A%2F%2Flocalhost%3A4000%2F2009%2F06%2Ffeature-for-adding-a-icon-to-your-sharepoint-farm%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn" target="_blank" rel="noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/2009/06/adding-profile-properties-through-code/" class="pagination--pager" title="Adding profile properties through code
">Previous</a>
    
    
      <a href="/2009/08/configure-kerberos-authentication/" class="pagination--pager" title="Configure Kerberos authentication
">Next</a>
    
  </nav>

    </pre>
</div>

    
  

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2023/05/creating-a-logic-app-api-connection-that-uses-the-managed-identity-using-bicep/" rel="permalink">Creating a Logic App API Connection that uses the Managed Identity using Bicep
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Logic Apps in Azure provides a platform for building workflows that integrate with various services and APIs. When creating Logic Apps, you must often connec...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2023/03/unlocking-the-power-of-azure-app-registrations-a-guide-to-exposing-your-app-as-an-api-with-user-assignments-required-turned-on/" rel="permalink">“Exposing Azure App Registrations as Secure APIs: A Guide to Authentication with ‘User Assignments Required’ Turned On”
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Azure App Registrations are a powerful tool for managing resource access and integrating applications with Microsoft's cloud services. While these registrati...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2022/12/centrally-manage-your-app-configurations/" rel="permalink">Centrally manage your App Configurations
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          10 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">The application landscape in Azure has grown significantly in recent years, with a wide range of tools and services available to help businesses build, deplo...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2022/10/shift-left-security-with-microsoft-security-devops-msdo/" rel="permalink">Shift Left Security with Microsoft Security DevOps (MSDO)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">With the new capabilities released add Ignite, you are now even more capable of shifting security checks further to the left. In this article, I explain how ...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</section>
</div>

    </article>
</div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap">
<form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term...">
  </form>
  <div id="results" class="results"></div>
</div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <script src="/assets/scripts/sidebarcontent.js"></script>
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/maikvandergaag" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/maikvandergaag" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/maikvandergaag/" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> Linkedin</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">© 2023 Maik van der Gaag. Powered by <a href="https://jekyllrb.com" rel="nofollow noopener noreferrer" target="_blank">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow noopener noreferrer" target="_blank">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </div></body>
</html>
