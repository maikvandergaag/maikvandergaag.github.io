<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Branding a SharePoint site – Part 1 - Microsoft Playground</title>
<meta name="description" content="Within SharePoint and WSS you have the possibility to brand your site. You can do this on several ways:  A custom style sheet.   A custom theme.  I think the best way to brand your SharePoint site is to create a custom theme.  You can create a theme by copying one of the themes folders in the “C:\Program Files\Common Files\microsoft shared\Web Server Extensions\12\TEMPLATE\THEMES” directory. When you have a copy of a directory you have to rename it to whatever you like. In this article we will use as example a copy of the “Simple” theme and rename it to “motion10”. In the directory you have three files that are necessary to create a theme. The images can be deleted. INF file In this file you can find information about your theme. The file contains two sections the [info] section and the [titles] section. In the [info] section information is given about the theme. In this section we have to change the title from “simple” to “motion10”. In the [titles] section the title of the theme is given for each language code besides the title for the language code 1033. This title is saved into SPThemes.xml file (This file will be discussed later in this article). After we made the changes to the file we save and rename it. You have to give it the same name as your folder. We will rename it from “Simple.inf” to “motion10.inf”. Theme.css The theme.css file is the style sheet file off the theme. In this file you will have to define your own styling. mossExtension.css The mossExtension.css is an extension file for the Theme.css file. When the Theme.css file is loaded it will be extended with the content of this file. When you want to create a custom theme you can use several tools to help you edit the theme.css file. One of my favorites is the Web Developers tool in Internet Explorer 8. You can use this tool by opening your SharePoint site and selecting: “Tools – Developer Tools” or just press F12. This will open a window like below. If you select the arrow at the top of the page you are able to select a section of your site and see the css styling of it.  On my SharePoint site I have selected the site title. On the right side of the developer tool you can see the styling of the site title. Every item that is stripped away will not be used so you can see that the colour of the title is changes to #0066a4 in moti1011-65001.css. This file is the theme.css file in our motion10 theme folder.  When you are done with the creation of the theme you have to make it available within the SharePoint farm. The theme can be added by updating the “SPThemes.xml” file within the following directory: C:\Program Files\Common Files\microsoft shared\Web Server Extensions\12\TEMPLATE\LAYOUTS\1033 If you examine the file you can see that every theme has its own section. You have to add a section for your theme. You can do this by copying one of the Templates nodes and pasting it into the file and change the following properties:  TemplateID: The ID of your template. This has be the same name as your folder. In our example it will be “motion10”.   DisplayName: This is the display name for your theme.   Description: This is the description of your theme.   Thumbnail: This is the URL to a picture that represents your theme. This will be shown on the themes page. Example: “images/motion10/theme/theme.jpg”.   Preview: This is the URL to a picture that represents your theme. Example: “images/motion10/theme/theme.jpg”.  When you save the file the theme will be available in the SharePoint Farm.  “Important: When you use multiple servers in the SharePoint farm you will have to change the SPThemes file on every server. You also have to create the themes folder on every server.” Manually editing of files in the farm is not desired and support. To solve this you have to create a solution using WSP Builder and add your Theme folder to the right path in your solution. You also have to make changes to the “SPThemes.xml” so you also add this file to your solution. You will have a problem with this because you have the complete file and extend it with you section. When you deploy your solution the out of the box file will be overwritten. But what happens when another SharePoint developer also makes a theme en deploys it to the server. He will also overwrite the file with the result that your theme will be deleted. To work around this problem you have to create a farm feature that will kick off a timer job to alter the SPThemes file. First we have to create a farm scoped feature that has a feature receiver.  &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;  &lt;Feature  Id=&quot;e0c634c2-5378-4fe6-927b-03aa895b5d8d&quot;                Title=&quot;motion10 Theme Installer : motion10&quot;                Description=&quot;Feature for adding the motion10 theme to the SharePoint Farm.&quot;                Version=&quot;12.0.0.0&quot;                Hidden=&quot;FALSE&quot;                Scope=&quot;Farm&quot;                DefaultResourceFile=&quot;core&quot;                ReceiverAssembly=&quot;Motion10.SharePoint.Theme, Version=1.0.0.0, Culture=neutral, PublicKeyToken=09e87b786333535e&quot;                ReceiverClass=&quot;Motion10.SharePoint.Theme.ThemeInstaller&quot;                Creator=&quot;Maik van der Gaag&quot;                ImageUrl=&quot;motion10/FeaturesIcon.png&quot;                ImageUrlAltText=&quot;http://www.motion10.com&quot;                xmlns=&quot;http://schemas.microsoft.com/sharepoint/&quot;&gt;    &lt;Properties&gt;      &lt;Property Key=&quot;Theme:TemplateID&quot; Value=&quot;motion10&quot; /&gt;      &lt;Property Key=&quot;Theme:DisplayName&quot; Value=&quot;motion10&quot; /&gt;      &lt;Property Key=&quot;Theme:Description&quot; Value=&quot;Theme for enabling the motion10 styling.&quot; /&gt;      &lt;Property Key=&quot;Theme:Thumbnail&quot; Value=&quot;images/motion10/theme/theme.jpg&quot; /&gt;      &lt;Property Key=&quot;Theme:Preview&quot; Value=&quot;images/motion10/theme/theme.jpg&quot; /&gt;    &lt;/Properties&gt;  &lt;/Feature&gt;">


  <meta name="author" content="Maik van der Gaag">
  
  <meta property="article:author" content="Maik van der Gaag">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Microsoft Playground">
<meta property="og:title" content="Branding a SharePoint site – Part 1">
<meta property="og:url" content="http://localhost:4000/2009/05/branding-a-sharepoint-site-part-1/">


  <meta property="og:description" content="Within SharePoint and WSS you have the possibility to brand your site. You can do this on several ways:  A custom style sheet.   A custom theme.  I think the best way to brand your SharePoint site is to create a custom theme.  You can create a theme by copying one of the themes folders in the “C:\Program Files\Common Files\microsoft shared\Web Server Extensions\12\TEMPLATE\THEMES” directory. When you have a copy of a directory you have to rename it to whatever you like. In this article we will use as example a copy of the “Simple” theme and rename it to “motion10”. In the directory you have three files that are necessary to create a theme. The images can be deleted. INF file In this file you can find information about your theme. The file contains two sections the [info] section and the [titles] section. In the [info] section information is given about the theme. In this section we have to change the title from “simple” to “motion10”. In the [titles] section the title of the theme is given for each language code besides the title for the language code 1033. This title is saved into SPThemes.xml file (This file will be discussed later in this article). After we made the changes to the file we save and rename it. You have to give it the same name as your folder. We will rename it from “Simple.inf” to “motion10.inf”. Theme.css The theme.css file is the style sheet file off the theme. In this file you will have to define your own styling. mossExtension.css The mossExtension.css is an extension file for the Theme.css file. When the Theme.css file is loaded it will be extended with the content of this file. When you want to create a custom theme you can use several tools to help you edit the theme.css file. One of my favorites is the Web Developers tool in Internet Explorer 8. You can use this tool by opening your SharePoint site and selecting: “Tools – Developer Tools” or just press F12. This will open a window like below. If you select the arrow at the top of the page you are able to select a section of your site and see the css styling of it.  On my SharePoint site I have selected the site title. On the right side of the developer tool you can see the styling of the site title. Every item that is stripped away will not be used so you can see that the colour of the title is changes to #0066a4 in moti1011-65001.css. This file is the theme.css file in our motion10 theme folder.  When you are done with the creation of the theme you have to make it available within the SharePoint farm. The theme can be added by updating the “SPThemes.xml” file within the following directory: C:\Program Files\Common Files\microsoft shared\Web Server Extensions\12\TEMPLATE\LAYOUTS\1033 If you examine the file you can see that every theme has its own section. You have to add a section for your theme. You can do this by copying one of the Templates nodes and pasting it into the file and change the following properties:  TemplateID: The ID of your template. This has be the same name as your folder. In our example it will be “motion10”.   DisplayName: This is the display name for your theme.   Description: This is the description of your theme.   Thumbnail: This is the URL to a picture that represents your theme. This will be shown on the themes page. Example: “images/motion10/theme/theme.jpg”.   Preview: This is the URL to a picture that represents your theme. Example: “images/motion10/theme/theme.jpg”.  When you save the file the theme will be available in the SharePoint Farm.  “Important: When you use multiple servers in the SharePoint farm you will have to change the SPThemes file on every server. You also have to create the themes folder on every server.” Manually editing of files in the farm is not desired and support. To solve this you have to create a solution using WSP Builder and add your Theme folder to the right path in your solution. You also have to make changes to the “SPThemes.xml” so you also add this file to your solution. You will have a problem with this because you have the complete file and extend it with you section. When you deploy your solution the out of the box file will be overwritten. But what happens when another SharePoint developer also makes a theme en deploys it to the server. He will also overwrite the file with the result that your theme will be deleted. To work around this problem you have to create a farm feature that will kick off a timer job to alter the SPThemes file. First we have to create a farm scoped feature that has a feature receiver.  &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;  &lt;Feature  Id=&quot;e0c634c2-5378-4fe6-927b-03aa895b5d8d&quot;                Title=&quot;motion10 Theme Installer : motion10&quot;                Description=&quot;Feature for adding the motion10 theme to the SharePoint Farm.&quot;                Version=&quot;12.0.0.0&quot;                Hidden=&quot;FALSE&quot;                Scope=&quot;Farm&quot;                DefaultResourceFile=&quot;core&quot;                ReceiverAssembly=&quot;Motion10.SharePoint.Theme, Version=1.0.0.0, Culture=neutral, PublicKeyToken=09e87b786333535e&quot;                ReceiverClass=&quot;Motion10.SharePoint.Theme.ThemeInstaller&quot;                Creator=&quot;Maik van der Gaag&quot;                ImageUrl=&quot;motion10/FeaturesIcon.png&quot;                ImageUrlAltText=&quot;http://www.motion10.com&quot;                xmlns=&quot;http://schemas.microsoft.com/sharepoint/&quot;&gt;    &lt;Properties&gt;      &lt;Property Key=&quot;Theme:TemplateID&quot; Value=&quot;motion10&quot; /&gt;      &lt;Property Key=&quot;Theme:DisplayName&quot; Value=&quot;motion10&quot; /&gt;      &lt;Property Key=&quot;Theme:Description&quot; Value=&quot;Theme for enabling the motion10 styling.&quot; /&gt;      &lt;Property Key=&quot;Theme:Thumbnail&quot; Value=&quot;images/motion10/theme/theme.jpg&quot; /&gt;      &lt;Property Key=&quot;Theme:Preview&quot; Value=&quot;images/motion10/theme/theme.jpg&quot; /&gt;    &lt;/Properties&gt;  &lt;/Feature&gt;">



  <meta property="og:image" content="http://localhost:4000/assets/profile/profile.png">



  <meta name="twitter:site" content="@maikvandergaag">
  <meta name="twitter:title" content="Branding a SharePoint site – Part 1">
  <meta name="twitter:description" content="Within SharePoint and WSS you have the possibility to brand your site. You can do this on several ways:  A custom style sheet.   A custom theme.  I think the best way to brand your SharePoint site is to create a custom theme.  You can create a theme by copying one of the themes folders in the “C:\Program Files\Common Files\microsoft shared\Web Server Extensions\12\TEMPLATE\THEMES” directory. When you have a copy of a directory you have to rename it to whatever you like. In this article we will use as example a copy of the “Simple” theme and rename it to “motion10”. In the directory you have three files that are necessary to create a theme. The images can be deleted. INF file In this file you can find information about your theme. The file contains two sections the [info] section and the [titles] section. In the [info] section information is given about the theme. In this section we have to change the title from “simple” to “motion10”. In the [titles] section the title of the theme is given for each language code besides the title for the language code 1033. This title is saved into SPThemes.xml file (This file will be discussed later in this article). After we made the changes to the file we save and rename it. You have to give it the same name as your folder. We will rename it from “Simple.inf” to “motion10.inf”. Theme.css The theme.css file is the style sheet file off the theme. In this file you will have to define your own styling. mossExtension.css The mossExtension.css is an extension file for the Theme.css file. When the Theme.css file is loaded it will be extended with the content of this file. When you want to create a custom theme you can use several tools to help you edit the theme.css file. One of my favorites is the Web Developers tool in Internet Explorer 8. You can use this tool by opening your SharePoint site and selecting: “Tools – Developer Tools” or just press F12. This will open a window like below. If you select the arrow at the top of the page you are able to select a section of your site and see the css styling of it.  On my SharePoint site I have selected the site title. On the right side of the developer tool you can see the styling of the site title. Every item that is stripped away will not be used so you can see that the colour of the title is changes to #0066a4 in moti1011-65001.css. This file is the theme.css file in our motion10 theme folder.  When you are done with the creation of the theme you have to make it available within the SharePoint farm. The theme can be added by updating the “SPThemes.xml” file within the following directory: C:\Program Files\Common Files\microsoft shared\Web Server Extensions\12\TEMPLATE\LAYOUTS\1033 If you examine the file you can see that every theme has its own section. You have to add a section for your theme. You can do this by copying one of the Templates nodes and pasting it into the file and change the following properties:  TemplateID: The ID of your template. This has be the same name as your folder. In our example it will be “motion10”.   DisplayName: This is the display name for your theme.   Description: This is the description of your theme.   Thumbnail: This is the URL to a picture that represents your theme. This will be shown on the themes page. Example: “images/motion10/theme/theme.jpg”.   Preview: This is the URL to a picture that represents your theme. Example: “images/motion10/theme/theme.jpg”.  When you save the file the theme will be available in the SharePoint Farm.  “Important: When you use multiple servers in the SharePoint farm you will have to change the SPThemes file on every server. You also have to create the themes folder on every server.” Manually editing of files in the farm is not desired and support. To solve this you have to create a solution using WSP Builder and add your Theme folder to the right path in your solution. You also have to make changes to the “SPThemes.xml” so you also add this file to your solution. You will have a problem with this because you have the complete file and extend it with you section. When you deploy your solution the out of the box file will be overwritten. But what happens when another SharePoint developer also makes a theme en deploys it to the server. He will also overwrite the file with the result that your theme will be deleted. To work around this problem you have to create a farm feature that will kick off a timer job to alter the SPThemes file. First we have to create a farm scoped feature that has a feature receiver.  &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;  &lt;Feature  Id=&quot;e0c634c2-5378-4fe6-927b-03aa895b5d8d&quot;                Title=&quot;motion10 Theme Installer : motion10&quot;                Description=&quot;Feature for adding the motion10 theme to the SharePoint Farm.&quot;                Version=&quot;12.0.0.0&quot;                Hidden=&quot;FALSE&quot;                Scope=&quot;Farm&quot;                DefaultResourceFile=&quot;core&quot;                ReceiverAssembly=&quot;Motion10.SharePoint.Theme, Version=1.0.0.0, Culture=neutral, PublicKeyToken=09e87b786333535e&quot;                ReceiverClass=&quot;Motion10.SharePoint.Theme.ThemeInstaller&quot;                Creator=&quot;Maik van der Gaag&quot;                ImageUrl=&quot;motion10/FeaturesIcon.png&quot;                ImageUrlAltText=&quot;http://www.motion10.com&quot;                xmlns=&quot;http://schemas.microsoft.com/sharepoint/&quot;&gt;    &lt;Properties&gt;      &lt;Property Key=&quot;Theme:TemplateID&quot; Value=&quot;motion10&quot; /&gt;      &lt;Property Key=&quot;Theme:DisplayName&quot; Value=&quot;motion10&quot; /&gt;      &lt;Property Key=&quot;Theme:Description&quot; Value=&quot;Theme for enabling the motion10 styling.&quot; /&gt;      &lt;Property Key=&quot;Theme:Thumbnail&quot; Value=&quot;images/motion10/theme/theme.jpg&quot; /&gt;      &lt;Property Key=&quot;Theme:Preview&quot; Value=&quot;images/motion10/theme/theme.jpg&quot; /&gt;    &lt;/Properties&gt;  &lt;/Feature&gt;">
  <meta name="twitter:url" content="http://localhost:4000/2009/05/branding-a-sharepoint-site-part-1/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="http://localhost:4000/assets/profile/profile.png">
    
  

  



  <meta property="article:published_time" content="2009-05-19T06:49:00+02:00">






<link rel="canonical" href="http://localhost:4000/2009/05/branding-a-sharepoint-site-part-1/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Maik van der Gaag",
      "url": "http://localhost:4000/",
      "sameAs": ["https://twitter.com/maikvandergaag","https://github.com/maikvandergaag"]
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Microsoft Playground Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<link rel="stylesheet" href="/assets/css/custom.css">

<!-- You can set your favicon here -->
<link rel="icon" type="image/png" sizes="32x32" href="/favicon.png">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Microsoft Playground
          <span class="site-subtitle">debug.write('Architecture, Azure, Azure DevOps, Git, GitHub, DevOps');</span>
        </a>
        <ul class="visible-links">
<li class="masthead__menu-item">
              <a href="/about">About</a>
            </li>
<li class="masthead__menu-item">
              <a href="/extensions">Extensions</a>
            </li>
<li class="masthead__menu-item">
              <a href="/speaking">Speaking</a>
            </li>
<li class="masthead__menu-item">
              <a href="/year-archive">Posts</a>
            </li>
<li class="masthead__menu-item">
              <a href="/categories">Categories</a>
            </li>
</ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/profile/profile.png" alt="Maik van der Gaag" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Maik van der Gaag</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>I am <strong>Microsoft Azure MVP</strong>, <strong>Speaker</strong> and <strong>Father</strong>.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Schiedam, The Netherlands</span>
        </li>
      

      
        
          
            <li><a href="https://twitter.com/maikvandergaag" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/maikvandergaag" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/maikvandergaag/" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">Linkedin</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Branding a SharePoint site – Part 1">
    <meta itemprop="description" content='Within SharePoint and WSS you have the possibility to brand your site. You can do this on several ways:A custom style sheet.  A custom theme.I think the best way to brand your SharePoint site is to create a custom theme. You can create a theme by copying one of the themes folders in the “C:\Program Files\Common Files\microsoft shared\Web Server Extensions\12\TEMPLATE\THEMES” directory. When you have a copy of a directory you have to rename it to whatever you like.In this article we will use as example a copy of the “Simple” theme and rename it to “motion10”.In the directory you have three files that are necessary to create a theme. The images can be deleted.INF file In this file you can find information about your theme. The file contains two sections the [info] section and the [titles] section.In the [info] section information is given about the theme. In this section we have to change the title from “simple” to “motion10”.In the [titles] section the title of the theme is given for each language code besides the title for the language code 1033. This title is saved into SPThemes.xml file (This file will be discussed later in this article).After we made the changes to the file we save and rename it. You have to give it the same name as your folder. We will rename it from “Simple.inf” to “motion10.inf”.Theme.css The theme.css file is the style sheet file off the theme. In this file you will have to define your own styling.mossExtension.css The mossExtension.css is an extension file for the Theme.css file. When the Theme.css file is loaded it will be extended with the content of this file.When you want to create a custom theme you can use several tools to help you edit the theme.css file. One of my favorites is the Web Developers tool in Internet Explorer 8. You can use this tool by opening your SharePoint site and selecting: “Tools – Developer Tools” or just press F12.This will open a window like below. If you select the arrow at the top of the page you are able to select a section of your site and see the css styling of it.On my SharePoint site I have selected the site title. On the right side of the developer tool you can see the styling of the site title. Every item that is stripped away will not be used so you can see that the colour of the title is changes to #0066a4 in moti1011-65001.css. This file is the theme.css file in our motion10 theme folder. When you are done with the creation of the theme you have to make it available within the SharePoint farm. The theme can be added by updating the “SPThemes.xml” file within the following directory:C:\Program Files\Common Files\microsoft shared\Web Server Extensions\12\TEMPLATE\LAYOUTS\1033If you examine the file you can see that every theme has its own section. You have to add a section for your theme. You can do this by copying one of the Templates nodes and pasting it into the file and change the following properties:TemplateID: The ID of your template. This has be the same name as your folder. In our example it will be “motion10”.  DisplayName: This is the display name for your theme.  Description: This is the description of your theme.  Thumbnail: This is the URL to a picture that represents your theme. This will be shown on the themes page. Example: “images/motion10/theme/theme.jpg”.  Preview: This is the URL to a picture that represents your theme. Example: “images/motion10/theme/theme.jpg”.When you save the file the theme will be available in the SharePoint Farm. “Important: When you use multiple servers in the SharePoint farm you will have to change the SPThemes file on every server. You also have to create the themes folder on every server.”Manually editing of files in the farm is not desired and support. To solve this you have to create a solution using WSP Builder and add your Theme folder to the right path in your solution. You also have to make changes to the “SPThemes.xml” so you also add this file to your solution. You will have a problem with this because you have the complete file and extend it with you section. When you deploy your solution the out of the box file will be overwritten. But what happens when another SharePoint developer also makes a theme en deploys it to the server. He will also overwrite the file with the result that your theme will be deleted.To work around this problem you have to create a farm feature that will kick off a timer job to alter the SPThemes file.First we have to create a farm scoped feature that has a feature receiver. &lt;?xml version="1.0" encoding="utf-8"?&gt; &lt;Feature  Id="e0c634c2-5378-4fe6-927b-03aa895b5d8d"               Title="motion10 Theme Installer : motion10"               Description="Feature for adding the motion10 theme to the SharePoint Farm."               Version="12.0.0.0"               Hidden="FALSE"               Scope="Farm"               DefaultResourceFile="core"               ReceiverAssembly="Motion10.SharePoint.Theme, Version=1.0.0.0, Culture=neutral, PublicKeyToken=09e87b786333535e"               ReceiverClass="Motion10.SharePoint.Theme.ThemeInstaller"               Creator="Maik van der Gaag"               ImageUrl="motion10/FeaturesIcon.png"               ImageUrlAltText="http://www.motion10.com"               xmlns="http://schemas.microsoft.com/sharepoint/"&gt;   &lt;Properties&gt;     &lt;Property Key="Theme:TemplateID" Value="motion10" /&gt;     &lt;Property Key="Theme:DisplayName" Value="motion10" /&gt;     &lt;Property Key="Theme:Description" Value="Theme for enabling the motion10 styling." /&gt;     &lt;Property Key="Theme:Thumbnail" Value="images/motion10/theme/theme.jpg" /&gt;     &lt;Property Key="Theme:Preview" Value="images/motion10/theme/theme.jpg" /&gt;   &lt;/Properties&gt; &lt;/Feature&gt; '>
    <meta itemprop="datePublished" content="2009-05-19T06:49:00+02:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Branding a SharePoint site – Part 1
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
        <div class="ExternalClass24C09A8CA3EE426CA7BD14F48C67687D">
<p>Within SharePoint and WSS you have the possibility to brand your site. You can do this on several ways:</p>
<ul>
<li>A custom style sheet.  </li>
<li>A custom theme.</li>
</ul>
<p>I think the best way to brand your SharePoint site is to create a custom theme. </p>
<p>You can create a theme by copying one of the themes folders in the “C:\Program Files\Common Files\microsoft shared\Web Server Extensions\12\TEMPLATE\THEMES” directory. When you have a copy of a directory you have to rename it to whatever you like.</p>
<p>In this article we will use as example a copy of the “Simple” theme and rename it to “motion10”.</p>
<p>In the directory you have three files that are necessary to create a theme. The images can be deleted.</p>
<p><strong>INF file</strong> <br>In this file you can find information about your theme. The file contains two sections the [info] section and the [titles] section.</p>
<p>In the [info] section information is given about the theme. In this section we have to change the title from “simple” to “motion10”.</p>
<p>In the [titles] section the title of the theme is given for each language code besides the title for the language code 1033. This title is saved into SPThemes.xml file (This file will be discussed later in this article).</p>
<p>After we made the changes to the file we save and rename it. You have to give it the same name as your folder. We will rename it from “Simple.inf” to “motion10.inf”.</p>
<p><strong>Theme.css</strong> <br>The theme.css file is the style sheet file off the theme. In this file you will have to define your own styling.</p>
<p><strong>mossExtension.css</strong> <br>The mossExtension.css is an extension file for the Theme.css file. When the Theme.css file is loaded it will be extended with the content of this file.</p>
<p>When you want to create a custom theme you can use several tools to help you edit the theme.css file. One of my favorites is the Web Developers tool in Internet Explorer 8. You can use this tool by opening your SharePoint site and selecting: “Tools – Developer Tools” or just press F12.</p>
<p>This will open a window like below. If you select the arrow at the top of the page you are able to select a section of your site and see the css styling of it.</p>
<p><a href="http://msftplayground.com/wp-content/uploads/2012/10/developertoolsselected.png" target="_blank" rel="noopener noreferrer"><img title="developertoolsselected" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="developertoolsselected" src="/assets/archive/2009/05/developertoolsselected_thumb.png" width="240" height="145"></a></p>
<p>On my SharePoint site I have selected the site title. On the right side of the developer tool you can see the styling of the site title. Every item that is stripped away will not be used so you can see that the colour of the title is changes to #0066a4 in moti1011-65001.css. This file is the theme.css file in our motion10 theme folder. </p>
<p>When you are done with the creation of the theme you have to make it available within the SharePoint farm. The theme can be added by updating the “SPThemes.xml” file within the following directory:</p>
<p><em>C:\Program Files\Common Files\microsoft shared\Web Server Extensions\12\TEMPLATE\LAYOUTS\1033</em></p>
<p>If you examine the file you can see that every theme has its own section. You have to add a section for your theme. You can do this by copying one of the Templates nodes and pasting it into the file and change the following properties:</p>
<ul>
<li>
<strong>TemplateID:</strong> The ID of your template. This has be the same name as your folder. In our example it will be “motion10”.  </li>
<li>
<strong>DisplayName:</strong> This is the display name for your theme.  </li>
<li>
<strong>Description:</strong> This is the description of your theme.  </li>
<li>
<strong>Thumbnail:</strong> This is the URL to a picture that represents your theme. This will be shown on the themes page. Example: “images/motion10/theme/theme.jpg”.  </li>
<li>
<strong>Preview:</strong> This is the URL to a picture that represents your theme. Example: “images/motion10/theme/theme.jpg”.</li>
</ul>
<p>When you save the file the theme will be available in the SharePoint Farm. </p>
<p><em>“<strong>Important: </strong>When you use multiple servers in the SharePoint farm you will have to change the SPThemes file on every server. You also have to create the themes folder on every server.”</em></p>
<p>Manually editing of files in the farm is not desired and support. To solve this you have to create a solution using WSP Builder and add your Theme folder to the right path in your solution. You also have to make changes to the “SPThemes.xml” so you also add this file to your solution. You will have a problem with this because you have the complete file and extend it with you section. When you deploy your solution the out of the box file will be overwritten. But what happens when another SharePoint developer also makes a theme en deploys it to the server. He will also overwrite the file with the result that your theme will be deleted.</p>
<p>To work around this problem you have to create a farm feature that will kick off a timer job to alter the SPThemes file.</p>
<p>First we have to create a farm scoped feature that has a feature receiver.</p>
<pre class="highlight"> &lt;?xml version="1.0" encoding="utf-8"?&gt;
 &lt;Feature  Id="e0c634c2-5378-4fe6-927b-03aa895b5d8d"
               Title="motion10 Theme Installer : motion10"
               Description="Feature for adding the motion10 theme to the SharePoint Farm."
               Version="12.0.0.0"
               Hidden="FALSE"
               Scope="Farm"
               DefaultResourceFile="core"
               ReceiverAssembly="Motion10.SharePoint.Theme, Version=1.0.0.0, Culture=neutral, PublicKeyToken=09e87b786333535e"
               ReceiverClass="Motion10.SharePoint.Theme.ThemeInstaller"
               Creator="Maik van der Gaag"
               ImageUrl="motion10/FeaturesIcon.png"
               ImageUrlAltText="http://www.motion10.com"
               xmlns="http://schemas.microsoft.com/sharepoint/"&gt;
   &lt;Properties&gt;
     &lt;Property Key="Theme:TemplateID" Value="motion10" /&gt;
     &lt;Property Key="Theme:DisplayName" Value="motion10" /&gt;
     &lt;Property Key="Theme:Description" Value="Theme for enabling the motion10 styling." /&gt;
     &lt;Property Key="Theme:Thumbnail" Value="images/motion10/theme/theme.jpg" /&gt;
     &lt;Property Key="Theme:Preview" Value="images/motion10/theme/theme.jpg" /&gt;
   &lt;/Properties&gt;
 &lt;/Feature&gt; 

In the properties section of the feature we have defined 5 properties. These properties represent the values that you have to fill into the SPThemes.xml.</pre>
<p>In the SPFeatureReceiver we will start the timer job to insert the values into the file.</p>
<pre class="highlight">public override void FeatureActivated(SPFeatureReceiverProperties properties) {
         RunJobNow(false, properties);
 }

 public override void FeatureDeactivating(SPFeatureReceiverProperties properties) {
         RunJobNow(true, properties);
 }

 public override void FeatureInstalled(SPFeatureReceiverProperties properties) {
 }

 public override void FeatureUninstalling(SPFeatureReceiverProperties properties) {
 } </pre>
<p>In the FeatureActivated and FeatureDeactivating event we call a method called “RunJobNow” with two properties. These properties represent a boolean if the section must be deleted and the property bag of the feature for retrieving the property values.</p>
<pre class="highlight">public void RunJobNow(bool delete, SPFeatureReceiverProperties prop) {

    SPFarm farm = prop.Definition.Farm;

    InstallThemeTimerJob newJob = null;

    foreach (SPService service in farm.Services) {
       if (service.Name == serviceName) {

          newJob = new InstallThemeTimerJob(service, prop.Definition.Id, delete);

          foreach (SPJobDefinition def in service.JobDefinitions) {
             if (def.Name == newJob.Name) {
                def.Delete();
             }
          }
         break;
       }
    }

    newJob.Schedule = new SPOneTimeSchedule(DateTime.Now.AddHours(-2.0));
    newJob.Title = string.Format("{0} Theme {1} for Feature {2}", delete ? "Delete" : "Install", prop.Definition.Properties["Theme:TemplateID"], prop.Definition.Id);
    newJob.Update();
 }</pre>
<p>The RunJobNow method will find a service called “WSSAdministration” on the farm. We need to find a service because the timer job needs to be attached to a service. By creating a new InstallThemeTimerJob object you create a new timer job in SharePoint. By adding the Schedule to the InstallThemeTimerJob object you can ensure that the job will run immediately.</p>
<p>When we create a new InstallThemeTimerJob object you can see that we have to define three properties. These properties must be defined to let the timer job know what to do.</p>
<p>When we have finished the feature it is time to create the timer job. In the SPJobDefinition we have four read only strings that define some values we need: </p>
<ul>
<li>
<strong>filePath:</strong> The path to the SPThemes.xml file : “TEMPLATE\\LAYOUTS\\1033\\SPTHEMES.XML”
</li>
<li>
<strong>deleteKey:</strong> The key of the property in the property bag.
</li>
<li>
<strong>featureKey:</strong> The key of the property in the property bag.
</li>
<li>
<strong>documentNameSpace:</strong> The namespace of the xml document.</li>
</ul>
<p>Within the timer job we have five properties to retrieve the properties from the feature definition. These properties need to be retrieved for adding our Templates section to the SPThemes file.</p>
<pre class="highlight"> public string TemplateID {
    get {
       SPFeatureDefinition def = Farm.FeatureDefinitions[this._featureID];

       SPFeatureProperty prop = def.Properties["Theme:TemplateID"];

       return prop.Value;
    }
 }</pre>
<p>For the initiation of our timer job we will have to insert two properties in the property bag. These properties are “_delete” and “_featureid”.</p>
<pre class="highlight">private readonly string deleteKey = "C11B44D604004a1d9CD9D0CAB326373F_Delete";

 private bool _delete {
    get {
       if (this.Properties.ContainsKey(deleteKey)) {
          return Convert.ToBoolean(this.Properties[deleteKey]);
       } else {
          return false;
       }
    }
    set {
       if (this.Properties.ContainsKey(deleteKey)) {
          this.Properties[deleteKey] = value.ToString();
       } else {
          this.Properties.Add(deleteKey, value.ToString());
       }
    }
 } </pre>
<p>For the creation of a timer job you also need to define a LockType. This LockType is very important because the timer job has to be run on every server in the farm. For accomplishing this we will have to use SPLockType.None ( http://www.shillier.com/archive/2009/05/01/where-is-my-timer-job.aspx)</p>
<pre class="highlight"> public InstallThemeTimerJob() {
 }

 public InstallThemeTimerJob(SPService service, Guid featureID, bool delete)
    : base("Themes Installer TimerJob", service, null, SPJobLockType.None) {

    //save the properties
    this._delete = delete;
    this._featureID = featureID;
 }</pre>
<p>On the execution of the timer job we will execute a method called ChangeThemesFile(). Within this method we will add or delete a section in the SPThemes file that is defined in the properties of the feature definition.</p>
<pre class="highlight">private readonly string filePath = "TEMPLATE\\LAYOUTS\\1033\\SPTHEMES.XML";
 private readonly string documentNameSpace = "http://tempuri.org/SPThemes.xsd";

 public override void Execute(Guid targetInstanceId) {
       base.Execute(targetInstanceId);

       this.ChangeThemesFile();
 }

  private void ChangeThemesFile() {

    XNamespace ns = documentNameSpace;
    string spThemesContent = string.Empty;

    XDocument doc = XDocument.Load(SPThemesFile);

    var element = from b in doc.Element(ns + "SPThemes").Elements(ns + "Templates")
                       where b.Element(ns + "TemplateID").Value == this.TemplateID
                       select b;


        
      

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#branding" class="page__taxonomy-item" rel="tag">Branding</a><span class="sep">, </span>
    
      <a href="/tags/#css" class="page__taxonomy-item" rel="tag">CSS</a><span class="sep">, </span>
    
      <a href="/tags/#development" class="page__taxonomy-item" rel="tag">Development</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#design" class="page__taxonomy-item" rel="tag">Design</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2009-05-19T06:49:00+02:00">May 19, 2009</time></p>


      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?via=maikvandergaag&amp;text=Branding+a+SharePoint+site+%26ndash%3B+Part+1%20http%3A%2F%2Flocalhost%3A4000%2F2009%2F05%2Fbranding-a-sharepoint-site-part-1%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter" target="_blank" rel="noopener noreferrer"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2F2009%2F05%2Fbranding-a-sharepoint-site-part-1%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook" target="_blank" rel="noopener noreferrer"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A%2F%2Flocalhost%3A4000%2F2009%2F05%2Fbranding-a-sharepoint-site-part-1%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn" target="_blank" rel="noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/2009/04/sharepoint-2007-service-pack-2/" class="pagination--pager" title="SharePoint 2007 Service Pack 2
">Previous</a>
    
    
      <a href="/2009/05/branding-a-sharepoint-site-part-2/" class="pagination--pager" title="Branding a SharePoint site – Part 2
">Next</a>
    
  </nav>

    </pre>
</div>

    
  

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2023/05/creating-a-logic-app-api-connection-that-uses-the-managed-identity-using-bicep/" rel="permalink">Creating a Logic App API Connection that uses the Managed Identity using Bicep
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          2 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Logic Apps in Azure provides a platform for building workflows that integrate with various services and APIs. When creating Logic Apps, you must often connec...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2023/03/unlocking-the-power-of-azure-app-registrations-a-guide-to-exposing-your-app-as-an-api-with-user-assignments-required-turned-on/" rel="permalink">“Exposing Azure App Registrations as Secure APIs: A Guide to Authentication with ‘User Assignments Required’ Turned On”
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Azure App Registrations are a powerful tool for managing resource access and integrating applications with Microsoft's cloud services. While these registrati...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2022/12/centrally-manage-your-app-configurations/" rel="permalink">Centrally manage your App Configurations
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          10 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">The application landscape in Azure has grown significantly in recent years, with a wide range of tools and services available to help businesses build, deplo...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/2022/10/shift-left-security-with-microsoft-security-devops-msdo/" rel="permalink">Shift Left Security with Microsoft Security DevOps (MSDO)
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">With the new capabilities released add Ignite, you are now even more capable of shifting security checks further to the left. In this article, I explain how ...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</section>
</div>

    </article>
</div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap">
<form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term...">
  </form>
  <div id="results" class="results"></div>
</div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <script src="/assets/scripts/sidebarcontent.js"></script>
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://twitter.com/maikvandergaag" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/maikvandergaag" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/maikvandergaag/" rel="nofollow noopener noreferrer noopener noreferrer" target="_blank"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> Linkedin</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">© 2023 Maik van der Gaag. Powered by <a href="https://jekyllrb.com" rel="nofollow noopener noreferrer" target="_blank">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow noopener noreferrer" target="_blank">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </div></body>
</html>
